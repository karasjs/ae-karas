{"version":3,"file":"index.jsx","sources":["../../es/enums.js","../../es/parse/transform.js","../../es/parse/vector.js","../../es/render.js","../../es/parse/index.js","../../es/convert/path.js","../../es/convert/animate.js","../../es/convert/index.js","../../es/index.js"],"sourcesContent":["export default {\n  ES_TYPE: {\n    FOLDER_ITEM: 'FolderItem',\n    FOOTAGE_ITEM: 'FootageItem',\n    COMP_ITEM: 'CompItem',\n    UNKNOWN: 'unknown',\n  },\n  EVENT: {\n    INIT: 'ae2karas:init',\n    LOG: 'ae2karas:log',\n    WARN: 'ae2karas:warn',\n    ERROR: 'ae2karas:error',\n    FINISH: 'ae2karas:finish',\n    CANCEL: 'ae2karas:cancel',\n    ADD_TEMP: 'ae2karas:addTemp',\n    DEL_TEMP: 'ae2karas:delTemp',\n  },\n};\n","const LAYER_TRANSFORM = {\n  'ADBE Anchor Point': 'anchorPoint',\n  'ADBE Position': 'position',\n  'ADBE Position_0': 'position_0',\n  'ADBE Position_1': 'position_1',\n  'ADBE Position_2': 'position_2',\n  'ADBE Scale': 'scale',\n  'ADBE Orientation': 'orientation',\n  'ADBE Rotate X': 'rotateX',\n  'ADBE Rotate Y': 'rotateY',\n  'ADBE Rotate Z': 'rotateZ',\n  'ADBE Opacity': 'opacity',\n};\n\nconst VECTOR_TRANSFORM = {\n  'ADBE Vector Anchor': 'anchorPoint',\n  'ADBE Vector Position': 'position',\n  'ADBE Vector Scale': 'scale',\n  'ADBE Vector Skew': 'skew',\n  'ADBE Vector Skew Axis': 'skewAxis',\n  'ADBE Vector Rotation': 'rotateZ',\n  'ADBE Vector Group Opacity': 'opacity',\n  'ADBE Vector Trim Start': 'start',\n  'ADBE Vector Trim End': 'end',\n};\n\nconst MASK_TRANSFORM = {\n  'ADBE Mask Shape': 'points',\n  'ADBE Mask Opacity': 'opacity',\n};\n\nfunction getPropertyValues(prop, matchName, noEasing) {\n  let { numKeys } = prop;\n  // 根据关键帧数量，2+帧是普通变化，1帧等同于0帧value\n  if(numKeys && numKeys > 1) {\n    let arr = [];\n    for(let i = 1; i <= numKeys; i++) {\n      // 特殊的曲线位移动画用translatePath表示\n      if(i !== numKeys && (matchName === 'ADBE Position' || matchName === 'ADBE Vector Position')) {\n        let v1 = prop.keyValue(i), v2 = prop.keyValue(i + 1);\n        let c1 = prop.keyOutSpatialTangent(i), c2 = prop.keyInSpatialTangent(i + 1);\n        // y = kx + b，看是否有曲线，没有忽略\n        let x1 = v1[0], y1 = v1[1], x2 = v2[0], y2 = v2[1];\n        if((x1 !== x2 || y1 !== y2) && (c1[0] !== 0 || c1[1] !== 0 || c2[0] !== 0 || c2[1] !== 0)) {\n          let p1 = [v1[0] + c1[0], v1[1] + c1[1]], p2 = [v2[0] + c2[0], v2[1] + c2[1]];\n          // 垂直特殊情况\n          if(x1 === 0 && x2 === 0) {\n            if(Math.abs(c1[0]) >= 1 || Math.abs(c2[0]) >= 1) {\n              let o = {\n                time: prop.keyTime(i) * 1000,\n                value: [x1, y1, p1[0], p1[1], p2[0], p2[1], x2, y2],\n              };\n              if(i !== numKeys && !noEasing) {\n                o.easing = getEasing(prop, i, i + 1);\n              }\n              arr.push(o);\n              continue;\n            }\n          }\n          // 二元一次方程\n          else {\n            let k, b;\n            if(x1 === 0) {\n              b = y1;\n              k = (y2 - b) / x2;\n            }\n            else if(x2 === 0) {\n              b = y2;\n              k = (y1 - b) / x1;\n            }\n            else {\n              let r = x1 / x2;\n              b = (y1 - y2 * r) / (1 - r);\n              k = (y1 - b) / x1;\n            }\n            // 精度小于一定认为无效\n            let is1 = Math.abs(k * p1[0] + b - p1[1]) >= 1;\n            let is2 = Math.abs(k * p2[0] + b - p2[1]) >= 1;\n            if(is1 || is2) {\n              let o = {\n                time: prop.keyTime(i) * 1000,\n                value: [x1, y1, p1[0], p1[1], p2[0], p2[1], x2, y2],\n              };\n              if(i !== numKeys && !noEasing) {\n                o.easing = getEasing(prop, i, i + 1);\n              }\n              arr.push(o);\n              continue;\n            }\n          }\n        }\n      }\n      let o = {\n        time: prop.keyTime(i) * 1000,\n        value: prop.keyValue(i),\n      };\n      if(i !== numKeys && !noEasing) {\n        o.easing = getEasing(prop, i, i + 1);\n      }\n      arr.push(o);\n    }\n    return arr;\n  }\n  else if(numKeys && numKeys > 0) {\n    return [prop.keyValue(1)];\n  }\n  else {\n    return [prop.value];\n  }\n}\n\n/**\n * https://www.zhihu.com/question/24404065\n * 柄点1的X值 = 关键帧1的影响值/100\n * 柄点1的Y值 = 关键帧1的输出速度/两关键帧平均速度*柄点1的X值\n * 柄点2的X值 = 1 - 关键帧2的影响值/100\n * 柄点2的Y值 = 1 - 关键帧2的输入速度/两关键帧平均速度*柄点2的X值\n * @param prop\n * @param start\n * @param end\n */\nfunction getEasing(prop, start, end) {\n  let t1 = prop.keyTime(start), t2 = prop.keyTime(end);\n  let v1 = prop.keyValue(start), v2 = prop.keyValue(end);\n  let e1 = prop.keyOutTemporalEase(start)[0], e2 = prop.keyInTemporalEase(end)[0];\n  // let c1 = prop.keyOutSpatialTangent(start), c2 = prop.keyInSpatialTangent(end);\n  // $.ae2karas.log(c1);\n  // $.ae2karas.log(c2);\n  let x1 = e1.influence * 0.01, x2 = 1 - e2.influence * 0.01;\n  let y1, y2;\n  let matchName = prop.matchName;\n  if([\n    'ADBE Anchor Point', 'ADBE Position',\n    'ADBE Vector Anchor', 'ADBE Vector Position',\n    'ADBE Scale', 'ADBE Vector Scale',\n    'ADBE Vector Skew'].indexOf(matchName) > -1) {\n    let avSpeedX = Math.abs(v2[0] - v1[0]) / (t2 - t1);\n    let avSpeedY = Math.abs(v2[1] - v1[1]) / (t2 - t1);\n    let avSpeed = Math.sqrt(avSpeedX * avSpeedX + avSpeedY * avSpeedY);\n    if(avSpeed !== 0) {\n      y1 = x1 * e1.speed / avSpeed;\n      y2 = 1 - (1 - x2) * e2.speed / avSpeed;\n    }\n  }\n  else if(v2 !== v1){\n    let avSpeed = Math.abs(v2 - v1) / (t2 - t1);\n    y1 = x1 * e1.speed / avSpeed;\n    y2 = 1 - (1 - x2) * e2.speed / avSpeed;\n  }\n  if(x1 === y1 && x2 === y2 || y1 === undefined || y2 === undefined) {\n    return;\n  }\n  return [x1, y1, x2, y2];\n}\n\nexport function transformLayer(prop) {\n  let res = {};\n  for(let i = 1; prop && i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(LAYER_TRANSFORM.hasOwnProperty(matchName)) {\n        res[LAYER_TRANSFORM[matchName]] = getPropertyValues(item, matchName, false);\n      }\n    }\n  }\n  return res;\n}\n\nexport function transformVector(prop) {\n  let res = {};\n  for(let i = 1; prop && i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(VECTOR_TRANSFORM.hasOwnProperty(matchName)) {\n        res[VECTOR_TRANSFORM[matchName]] = getPropertyValues(item, matchName, false);\n      }\n    }\n  }\n  return res;\n}\n\nexport function transformMask(prop) {\n  let res = {};\n  for(let i = 1; prop && i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(MASK_TRANSFORM.hasOwnProperty(matchName)) {\n        res[MASK_TRANSFORM[matchName]] = getPropertyValues(item, matchName, true);\n      }\n    }\n  }\n  return res;\n}\n\nexport function transformGeom(prop) {\n  return getPropertyValues(prop, '', true);\n}\n","import { transformVector, transformGeom } from './transform';\n\nfunction group(prop) {\n  let res = {};\n  // 这里是矩形1层，主要关注Groups属性即可，blendMode暂时无视，transform被上钻2层提前\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vectors Group':\n          res.content = content(item);\n          break;\n        case 'ADBE Vector Transform Group':\n          // 奇怪的地方，显示应该下钻2层到如rect同级，可实际提前了\n          res.transform = transformVector(item);\n          break;\n      }\n    }\n  }\n  res.content.transform = res.transform;\n  return res.content;\n}\n\nfunction content(prop) {\n  // 矩形1下面会多出一层内容层看不见，就是本层，其下面则是可视的子属性层\n  let res = {\n    name: prop.name,\n    content: [],\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape - Rect':\n          res.content.push(rect(item));\n          break;\n        case 'ADBE Vector Shape - Ellipse':\n          res.content.push(ellipse(item));\n          break;\n        case 'ADBE Vector Shape - Star':\n          res.content.push(star(item));\n          break;\n        case 'ADBE Vector Shape - Group':\n          res.content.push(path(item));\n          break;\n        case 'ADBE Vector Graphic - Stroke':\n          res.stroke = stroke(item);\n          break;\n        case 'ADBE Vector Graphic - Fill':\n          res.fill = fill(item);\n          break;\n        case 'ADBE Vector Graphic - G-Fill':\n          res.gFill = gFill(item);\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction rect(prop) {\n  // 矩形路径层\n  let res = {\n    type: 'rect',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Rect Size':\n          res.size = transformGeom(item);\n          break;\n        case 'ADBE Vector Rect Position':\n          res.position = transformGeom(item);\n          break;\n        case 'ADBE Vector Rect Roundness':\n          res.roundness = transformGeom(item);\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction ellipse(prop) {\n  let res = {\n    type: 'ellipse',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Ellipse Size':\n          res.size = transformGeom(item);\n          break;\n        case 'ADBE Vector Ellipse Position':\n          res.position = transformGeom(item);\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction star(prop) {\n  let res = {\n    type: 'star',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Star Type':\n          res.starType = item.value;\n          break;\n        case 'ADBE Vector Star Points':\n          res.points = item.value;\n          break;\n        case 'ADBE Vector Star Position':\n          res.position = item.value;\n          break;\n        case 'ADBE Vector Star Inner Radius':\n          res.innerRadius = item.value;\n          break;\n        case 'ADBE Vector Star Outer Radius':\n          res.outerRadius = item.value;\n          break;\n        case 'ADBE Vector Star Inner Roundess':\n          res.innerRoundness = item.value;\n          break;\n        case 'ADBE Vector Star Outer Roundess':\n          res.outerRoundness = item.value;\n          break;\n        case 'ADBE Vector Star Rotation':\n          res.rotation = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction stroke(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Stroke Color':\n          res.color = transformGeom(item);\n          break;\n        case 'ADBE Vector Stroke Opacity':\n          res.opacity = transformGeom(item);\n          break;\n        case 'ADBE Vector Stroke Width':\n          res.width = transformGeom(item);\n          break;\n        case 'ADBE Vector Line Cap':\n          res.lineCap = transformGeom(item);\n          break;\n        case 'ADBE Vector Stroke Line Join':\n          res.lineJoin = transformGeom(item);\n          break;\n        case 'ADBE Vector Stroke Miter Limit':\n          res.miterLimit = transformGeom(item);\n          break;\n        // case 'ADBE Vector Stroke Dashes':\n        //   res.dashes = dash(item);\n        //   break;\n      }\n    }\n  }\n  // 特殊的获取虚线样式\n  let dashes = prop.property('Dashes');\n  if(dashes) {\n    let d = [];\n    let g = [];\n    for(let i = 1; i <= dashes.numProperties; i++) {\n      let item = dashes.property(i);\n      if(item && item.enabled) {\n        let matchName = item.matchName;\n        if(item.canSetExpression) {\n          if(matchName.indexOf('ADBE Vector Stroke Dash') > -1) {\n            let j = /\\d+/.exec(matchName);\n            d[j[0] - 1] = item.value;\n          }\n          else if (matchName.indexOf('ADBE Vector Stroke Gap') > -1) {\n            let j = /\\d+/.exec(matchName);\n            g[j[0] - 1] = item.value;\n          }\n        }\n      }\n    }\n    if(d.length) {\n      let v = [];\n      for(let i = 0, len = d.length; i < len; i++) {\n        v.push(d[i]);\n        if(g[i] === undefined) {\n          v.push(d[i]);\n        }\n        else {\n          v.push(g[i]);\n        }\n      }\n      res.dashes = v;\n    }\n  }\n  return res;\n}\n\nfunction path(prop) {\n  let res = {\n    type: 'path',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Shape':\n          res.points = transformGeom(item);\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction fill(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Fill Rule':\n          res.rule = item.value;\n          break;\n        case 'ADBE Vector Fill Color':\n          res.color = transformGeom(item);\n          break;\n        case 'ADBE Vector Fill Opacity':\n          res.opacity = transformGeom(item);\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction gFill(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Composite Order':\n          break;\n        case 'ADBE Vector Fill Rule':\n          res.rule = item.value;\n          break;\n        case 'ADBE Vector Grad Type':\n          res.type = item.value;\n          break;\n        case 'ADBE Vector Grad Start Pt':\n          res.start = item.value;\n          break;\n        case 'ADBE Vector Grad End Pt':\n          res.end = item.value;\n          break;\n        case 'ADBE Vector Grad Colors':\n          // 拿不到\n          break;\n        case 'ADBE Vector Fill Opacity':\n          res.opacity = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nexport default function(prop, library) {\n  let res = {};\n  // 这里是内容层，一般只有1个属性，如矩形1\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Group':\n          res.shape = group(item, library);\n          break;\n        case 'ADBE Vector Filter - Trim':\n          res.trim = transformVector(item);\n          break;\n      }\n    }\n  }\n  return res;\n};\n","export default {\n  psd2png(source, psd, path, name) {\n    let helperSequenceComp = app.project.items.addComp('tempConverterComp', source.width, source.height, 1, 1, 1);\n    helperSequenceComp.layers.add(source);\n    $.ae2karas.addTemp(helperSequenceComp);\n\n    let item = app.project.renderQueue.items.add(helperSequenceComp);\n    $.ae2karas.addTemp(item);\n\n    let outputModule = item.outputModule(1);\n    outputModule.applyTemplate(\"_HIDDEN X-Factor 8 Premul\");\n    let fileName = path + name;\n    let file = new File(fileName);\n    if(file.exists) {\n      file.remove();\n    }\n    outputModule.file = new File(fileName);\n\n    item.onStatusChanged = function() {\n      // 完成后要重命名，因为ae会追加00000到文件名末尾\n      if(item.status === RQItemStatus.DONE) {\n        let bug = new File(fileName + '00000');\n        if(bug.exists) {\n          bug.rename(name);\n        }\n      }\n    };\n    app.project.renderQueue.render();\n  },\n};\n","import { transformLayer, transformMask } from './transform';\nimport vector from './vector';\nimport render from '../render';\n\nlet uuid = 0;\n\nfunction recursion(composition, library) {\n  let { name, layers, width, height, displayStartTime, duration } = composition;\n  $.ae2karas.error('composition: ' + name);\n  // 是否是独奏模式\n  let hasSolo;\n  for(let i = 1; i <= layers.length; i++) {\n    let item = layers[i];\n    if(item.solo) {\n      hasSolo = true;\n      break;\n    }\n  }\n  // 再统计哪些层被作为父级链接，asParent以索引为key是否父级链接为值，asChild以索引为key父级索引为值\n  let asParent = {}, asChild = {};\n  for(let i = 1; i <= layers.length; i++) {\n    let item = layers[i];\n    if(hasSolo) {\n      if(!item.solo) {\n        continue;\n      }\n    }\n    else {\n      if(!item.enabled) {\n        continue;\n      }\n    }\n    if(item.parent && item.parent.index) {\n      asParent[item.parent.index] = true;\n      asChild[item.index] = item.parent.index;\n    }\n  }\n  // 遍历分析图层，独奏时只看独奏图层，否则看可见图层\n  let children = [];\n  outer:\n  for(let i = 1; i <= layers.length; i++) {\n    let item = layers[i];\n    let index = item.index;\n    // 根据是否独奏或可见决定是否分析或跳过，被作为父级链接的即便不可见也要统计\n    if(!asParent.hasOwnProperty(index)) {\n      if(hasSolo) {\n        if(!item.solo && !item.isTrackMatte) {\n          continue;\n        }\n      }\n      else {\n        if(!item.enabled && !item.isTrackMatte) {\n          continue;\n        }\n      }\n    }\n    // mask看应用图层对象是否可见\n    if(item.isTrackMatte) {\n      for(let j = i + 1; j <= layers.length; j++) {\n        let item2 = layers[j];\n        if(!item2.isTrackMatte) {\n          if(hasSolo) {\n            if(!item2.solo) {\n              continue outer;\n            }\n          }\n          else {\n            if(!item2.enabled) {\n              continue outer;\n            }\n          }\n        }\n      }\n    }\n    let o = parseLayer(item, library, hasSolo);\n    if(o) {\n      // 父级打标uuid的同时，之前记录的hash也记录下来\n      if(asParent.hasOwnProperty(index)) {\n        asParent[index] = o.asParent = uuid++;\n      }\n      // mask/clip类型在被遮罩层上\n      if(i > 1 && o.isClip) {\n        let last = children[children.length - 1];\n        if(last && last.isMask) {\n          last.isClip = true;\n        }\n      }\n      children.push(o);\n    }\n  }\n  // children还要遍历一遍，根据父级链接增加指向父级的字段\n  for(let i = 0; i < children.length; i++) {\n    let item = children[i];\n    let index = item.index;\n    if(asChild.hasOwnProperty(index)) {\n      item.asChild = asParent[asChild[index]];\n    }\n  }\n  children.reverse();\n  return {\n    type: 'div',\n    name,\n    width,\n    height,\n    displayStartTime: displayStartTime * 1000, // 开始时间码\n    duration: duration * 1000, // 合成的总时长\n    children,\n  };\n}\n\nfunction parseLayer(layer, library, hasSolo) {\n  let res = {\n    name: layer.name,\n    index: layer.index,\n    width: layer.width,\n    height: layer.height,\n    startTime: layer.startTime * 1000, // 开始时间，即时间轴上本图层初始位置\n    inPoint: layer.inPoint * 1000, // 真正开始显示时间，>= startTime，可能有前置空白不显示的一段\n    outPoint: layer.outPoint * 1000, // 真正结束显示时间，<= duration绝对值，可能有后置空白不显示的一段\n    blendingMode: layer.blendingMode,\n    isMask: layer.isTrackMatte,\n    isClip: layer.trackMatteType === TrackMatteType.ALPHA_INVERTED,\n  };\n  // 标明图层是否可见，也许不可见但作为父级链接也要分析\n  if(hasSolo) {\n    res.enabled = layer.solo || layer.isTrackMatte;\n  }\n  else {\n    res.enabled = layer.enabled || layer.isTrackMatte;\n  }\n  $.ae2karas.warn('layer: ' + res.name);\n  let geom, txt;\n  for(let i = 1; i <= layer.numProperties; i++) {\n    let prop = layer.property(i);\n    if(prop && prop.enabled) {\n      let matchName = prop.matchName;\n      switch(matchName) {\n        case 'ADBE Transform Group':\n          res.transform = transformLayer(prop);\n          break;\n        case 'ADBE Root Vectors Group':\n          // 形状图层中的内容子属性\n          if(res.enabled) {\n            geom = vector(prop, library);\n          }\n          break;\n        case 'ADBE Mask Parade':\n          if(res.enabled) {\n            res.mask = mask(prop);\n          }\n          break;\n        case 'ADBE Text Properties':\n          if(res.enabled) {\n            txt = text(prop);\n          }\n          break;\n      }\n    }\n  }\n  // 可能是作为父级链接，如果不可见则不需要内容\n  if(res.enabled) {\n    let source = layer.source;\n    if(geom && geom.shape && geom.shape.content && geom.shape.content.length) {\n      geom.geom = true; // 特殊标识\n      geom.type = 'div';\n      geom.id = library.length;\n      library.push(geom);\n      res.assetId = geom.id;\n    }\n    else if(txt) {\n      txt.text = true; // 特殊标识\n      txt.type = 'span';\n      txt.id = library.length;\n      library.push(txt);\n      res.assetId = txt.id;\n    }\n    else if(source) {\n      let asset;\n      // 图片图形等独立资源，将其解析为被link的放入library即可\n      if(source instanceof FootageItem) {\n        let src = source.file && source.file.fsName;\n        let name = source.name;\n        if(/\\.psd$/.test(name)) {\n          let path = src.replace(/[^\\/]*\\.psd$/, '');\n          let newName = name.replace(/[\\/.]/g, '_') + '_layer_' + layer.index + '.png';\n          render.psd2png(source, src, path, newName);\n          src = path + newName;\n        }\n        if(!/\\.jpg$/.test(src)\n          && !/\\.jpeg$/.test(src)\n          && !/\\.png/.test(src)\n          && !/\\.webp/.test(src)\n          && !/\\.gif/.test(src)) {\n          return;\n        }\n        let hasExist;\n        for(let i = 0; i < library.length; i++) {\n          let item = library[i];\n          if(item.src === src && item.type === 'img') {\n            asset = item;\n            hasExist = true;\n            break;\n          }\n        }\n        if(!hasExist) {\n          if(src) {\n            asset = {\n              type: 'img',\n              name,\n              width: source.width,\n              height: source.height,\n              src,\n            };\n          }\n          // 颜色类型没有src\n          else {\n            asset = {\n              type: 'div',\n              width: source.width,\n              height: source.height,\n            }\n          }\n        }\n      }\n      // 合成，递归分析\n      else if(source instanceof CompItem) {\n        asset = recursion(source, library);\n        asset.type = 'div';\n      }\n      if(asset) {\n        asset.id = library.length;\n        library.push(asset);\n        res.assetId = asset.id;\n      }\n    }\n  }\n  return res;\n}\n\nfunction mask(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(matchName === 'ADBE Mask Atom') {\n        if(item.maskMode !== MaskMode.NONE) {\n          res.enabled = true;\n        }\n        res.list = transformMask(item);\n        res.mode = item.maskMode;\n        res.inverted = item.inverted;\n      }\n    }\n  }\n  return res;\n}\n\nfunction text(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Text Document':\n          let value = item.value;\n          res.content = {\n            fillColor: value.fillColor,\n            font: value.font,\n            fontFamily: value.fontFamily,\n            fontStyle: value.fontStyle,\n            fontSize: value.fontSize,\n            leading: value.leading,\n            baselineLocs: value.baselineLocs,\n            text: value.text,\n          };\n          if(value.boxText) {\n            res.content.size = value.boxTextSize;\n            res.content.position = value.boxTextPos;\n          }\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nexport default function(composition) {\n  $.ae2karas.error('parse');\n  // 递归遍历合成，转换ae的图层为普通js对象\n  let { workAreaStart, workAreaDuration } = composition;\n  workAreaStart *= 1000;\n  workAreaDuration *= 1000;\n  $.ae2karas.log('workArea: ' + workAreaStart + ',' + workAreaDuration);\n  let library = [];\n  let result = recursion(composition, library);\n  $.ae2karas.log(result);\n  $.ae2karas.log(library);\n  return {\n    workAreaStart,\n    workAreaDuration,\n    result,\n    library,\n  };\n}\n","export default {\n  parse(vertices, inTangents, outTangents, closed, x1, y1, x2, y2) {\n    if(x1 === undefined) {\n      x1 = x2 = vertices[0][0];\n      y1 = y2 = vertices[0][1];\n      // 控制点是相对于顶点的坐标\n      let it = inTangents[0], ot = outTangents[0];\n      if(it[0]) {\n        x1 = Math.max(x1, x1 + it[0]);\n        x2 = Math.min(x2, x1 + it[0]);\n      }\n      if(it[1]) {\n        y1 = Math.max(y1, y1 + it[1]);\n        y2 = Math.min(y2, y1 + it[1]);\n      }\n      if(ot[0]) {\n        x1 = Math.max(x1, x1 + ot[0]);\n        x2 = Math.min(x2, x1 + ot[0]);\n      }\n      if(ot[1]) {\n        y1 = Math.max(y1, y1 + ot[1]);\n        y2 = Math.min(y2, y1 + ot[1]);\n      }\n      // 循环获取极值\n      for(let i = 1, len = vertices.length; i < len; i++) {\n        let item = vertices[i];\n        x1 = Math.max(x1, item[0]);\n        y1 = Math.max(y1, item[1]);\n        x2 = Math.min(x2, item[0]);\n        y2 = Math.min(y2, item[1]);\n        // 控制点是相对于顶点的坐标\n        let it = inTangents[i], ot = outTangents[i];\n        if(it[0]) {\n          x1 = Math.max(x1, item[0] + it[0]);\n          x2 = Math.min(x2, item[0] + it[0]);\n        }\n        if(it[1]) {\n          y1 = Math.max(y1, item[1] + it[1]);\n          y2 = Math.min(y2, item[1] + it[1]);\n        }\n        if(ot[0]) {\n          x1 = Math.max(x1, item[0] + ot[0]);\n          x2 = Math.min(x2, item[0] + ot[0]);\n        }\n        if(ot[1]) {\n          y1 = Math.max(y1, item[1] + ot[1]);\n          y2 = Math.min(y2, item[1] + ot[1]);\n        }\n      }\n    }\n    let w = x1 - x2, h = y1 - y2;\n    let pts = [], cts = [];\n    for(let i = 0, len = vertices.length; i < len; i++) {\n      let item = vertices[i];\n      pts.push([\n        (item[0] - x2) / w,\n        (item[1] - y2) / h,\n      ]);\n      let it = inTangents[i], ot = outTangents[i];\n      // 上一个顶点到本顶点，即便控制点为空也要填补为顶点数据，为2帧之间动画过渡考虑\n      let j = i - 1;\n      if(j === -1) {\n        j = len - 1;\n      }\n      cts[j] = cts[j] || [];\n      cts[j].push((vertices[i][0] + it[0] - x2) / w);\n      cts[j].push((vertices[i][1] + it[1] - y2) / h);\n      // 本顶点到下一个顶点，最后一个比较特殊是到第一个，需要调整顺序\n      cts[i] = cts[i] || [];\n      let x = (vertices[i][0] + ot[0] - x2) / w, y = (vertices[i][1] + ot[1] - y2) / h;\n      if(i === len - 1) {\n        cts[i].unshift(y);\n        cts[i].unshift(x);\n      }\n      else {\n        cts[i].push(x);\n        cts[i].push(y);\n      }\n    }\n    if(closed) {\n      pts.push(pts[0].slice(0));\n    }\n    return {\n      x1,\n      y1,\n      x2,\n      y2,\n      width: w,\n      height: h,\n      points: pts,\n      controls: cts,\n    };\n  },\n  rect2polyline(width, height, roundness) {\n    roundness = roundness || 0;\n    let r = Math.min(width, height) * 0.5;\n    roundness = Math.min(roundness, r);\n    let pts = [], cts = [];\n    if(roundness && roundness > 0) {\n      let h = roundness * 0.5522847498307936;\n      pts.push([(width - roundness) / width, 0]);\n      cts.push([(width - roundness + h) / width, 0, 1, (roundness - h) / height]);\n      pts.push([1, roundness / height]);\n      cts.push([]);\n      pts.push([1, (height - roundness) / height]);\n      cts.push([1, (height - roundness + h) / height, (width - roundness + h) / width, 1]);\n      pts.push([(width - roundness) / width, 1]);\n      cts.push([]);\n      pts.push([roundness / width, 1]);\n      cts.push([(roundness - h) / width, 1, 0, (height - roundness + h) / height]);\n      pts.push([0, (height - roundness) / height]);\n      cts.push([]);\n      pts.push([0, roundness / height]);\n      cts.push([0, (roundness - h) / height, (roundness - h) / width, 0]);\n      pts.push([roundness / width, 0]);\n      cts.push([]);\n      pts.push([(width - roundness) / width, 0]);\n    }\n    else {\n      pts.push([1, 0]);\n      pts.push([1, 1]);\n      pts.push([0, 1]);\n      pts.push([0, 0]);\n      pts.push([1, 0]);\n    }\n    return {\n      points: pts,\n      controls: cts,\n    }\n  },\n  ellipse2polyline() {\n    let pts = [], cts = [];\n    let rx =  0.5 * 0.5522847498307936, ry = 0.5 * 0.5522847498307936;\n    pts.push([0.5, 0]);\n    cts.push([0.5 + rx, 0, 1, 0.5 - ry]);\n    pts.push([1, 0.5]);\n    cts.push([1, 0.5 + ry, 0.5 + rx, 1]);\n    pts.push([0.5, 1]);\n    cts.push([0.5 - rx, 1, 0, 0.5 + ry]);\n    pts.push([0, 0.5]);\n    cts.push([0, 0.5 - ry, rx, 0]);\n    pts.push([0.5, 0]);\n    return {\n      points: pts,\n      controls: cts,\n    }\n  },\n};\n","import path from './path';\n\n/**\n * 2个及以上的关键帧，获取区间，有可能有超过范围的无效关键帧，需滤除\n * 也有可能不及工作区间，需补充首尾，和原有首尾一样复制一个出来对齐区间\n * 也有可能虽然在范围外，但范围上无关键帧，需截取至范围内，由每个特效传入截取回调\n * @param list\n * @param begin\n * @param duration\n * @param reducer 当关键帧范围在工作区间外时，每个特效传入的截取函数\n * @returns {(number|number)[]}\n */\nfunction getAreaList(list, begin, duration, reducer) {\n  let len = list.length;\n  let startIndex = 0, endIndex = len - 1;\n  // 在区间外围的如果只有1帧则需包括，多余的去除，正好则符合，包含则需填补\n  for(let i = 0; i < len; i++) {\n    let item = list[i];\n    if(item.time < begin) {\n      startIndex = i;\n    }\n    else if(item.time > begin) {\n      break;\n    }\n    else {\n      startIndex = i;\n      break;\n    }\n  }\n  // 结尾同上\n  for(let i = len - 1; i >= 0; i--) {\n    let item = list[i];\n    if(item.time < begin + duration) {\n      break;\n    }\n    else if(item.time > begin + duration) {\n      endIndex = i;\n    }\n    else {\n      endIndex = i;\n      break;\n    }\n  }\n  if(startIndex > 0 || endIndex < len - 1) {\n    list = list.slice(startIndex, endIndex + 1);\n  }\n  // 补齐首帧，当关键帧在工作区间内的时候\n  let first = list[0];\n  if(first.time > begin) {\n    let o = {\n      time: begin,\n      value: Array.isArray(first.value) ? first.value.slice(0) : first.value,\n    };\n    // translatePath特殊处理，前补第一帧转为translate\n    if(Array.isArray(first.value) && first.value.length === 8) {\n      o.value = first.value.slice(0, 2);\n    }\n    list.unshift(o);\n  }\n  // 截取首帧部分\n  else if(first.time < begin) {\n    let next = list[1];\n    let percent = (begin - first.time) / (next.time - first.time);\n    first.time = begin;\n    first.value = reducer(first.value, next.value, percent, true);\n    if(first.easing) {\n      let points = sliceBezier([\n        [0, 0],\n        [first.easing[0], first.easing[1]],\n        [first.easing[2], first.easing[3]],\n        [1, 1],\n      ].reverse(), percent).reverse();\n      first.easing = [points[1][0], points[1][1], points[2][0], points[2][1]];\n    }\n  }\n  // 截取尾帧部分，同上\n  let last = list[list.length - 1];\n  if(last.time > begin + duration) {\n    let prev = list[list.length - 2];\n    let percent = (begin + duration - prev.time) / (last.time - prev.time);\n    last.time = begin + duration;\n    last.value = reducer(prev.value, last.value, percent);\n    if(prev.easing) {\n      let points = sliceBezier([\n        [0, 0],\n        [prev.easing[0], prev.easing[1]],\n        [prev.easing[2], prev.easing[3]],\n        [1, 1],\n      ], percent);\n      prev.easing = [points[1][0], points[1][1], points[2][0], points[2][1]];\n    }\n  }\n  // 补齐尾帧，同上\n  else if(last.time < begin + duration) {\n    let o = {\n      time: begin + duration,\n      value: Array.isArray(last.value) ? last.value.slice(0) : last.value,\n    };\n    list.push(o);\n  }\n  return list;\n}\n\n/**\n * 百分比截取贝塞尔中的一段，t为[0, 1]\n * @param points\n * @param t\n */\nfunction sliceBezier(points, t) {\n  let p1, p2, p3, p4;\n  if(points.length === 8) {\n    p1 = points.slice(0, 2);\n    p2 = points.slice(2, 4);\n    p3 = points.slice(4, 8);\n    p4 = points.slice(6, 8);\n  }\n  else {\n    p1 = points[0];\n    p2 = points[1];\n    p3 = points[2];\n    p4 = points[3];\n  }\n  let x1 = p1[0], y1 = p1[1];\n  let x2 = p2[0], y2 = p2[1];\n  let x3 = p3[0], y3 = p3[1];\n  let x12 = (x2 - x1) * t + x1;\n  let y12 = (y2 - y1) * t + y1;\n  let x23 = (x3 - x2) * t + x2;\n  let y23 = (y3 - y2) * t + y2;\n  let x123 = (x23 - x12) * t + x12;\n  let y123 = (y23 - y12) * t + y12;\n  if(points.length === 4 || points.length === 8) {\n    let x4 = p4[0], y4 = p4[1];\n    let x34 = (x4 - x3) * t + x3;\n    let y34 = (y4 - y3) * t + y3;\n    let x234 = (x34 - x23) * t + x23;\n    let y234 = (y34 - y23) * t + y23;\n    let x1234 = (x234 - x123) * t + x123;\n    let y1234 = (y234 - y123) * t + y123;\n    if(points.length === 8) {\n      return [x1, y1, x12, y12, x123, y123, x1234, y1234];\n    }\n    return [[x1, y1], [x12, y12], [x123, y123], [x1234, y1234]];\n  }\n  else if(points.length === 3) {\n    return [[x1, y1], [x12, y12], [x123, y123]];\n  }\n}\n\nexport function transformOrigin(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      transformOrigin: list[0][0] + ' ' + list[0][1],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        transformOrigin: item.value[0] + ' ' + item.value[1],\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformOpacity(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      opacity: list[0] * 0.01,\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        opacity: item.value * 0.01,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformPosition(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      translateX: list[0][0],\n      translateY: list[0][1],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent, isStart) {\n      // 特殊的translatePath曲线动画\n      if(prev.length === 8) {\n        if(isStart) {\n          let points = [];\n          for(let i = 0, len = prev.length; i < len; i++) {\n            let item = prev[i];\n            points.push(item);\n          }\n          points = sliceBezier(points.reverse(), percent);\n          return points.reverse();\n        }\n        else {\n          return sliceBezier(prev, percent);\n        }\n      }\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n        prev[2] + (next[2] - prev[2]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let o = {\n        offset: (item.time - begin) / duration,\n        easing: item.easing,\n      };\n      if(item.value.length === 8) {\n        o.translatePath = item.value;\n      }\n      else {\n        o.translateX = item.value[0];\n        o.translateY = item.value[1];\n      }\n      res.value.push(o);\n    }\n  }\n  return res;\n}\n\nexport function translateXY(list, begin, duration, key) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let o = {};\n    o[key] = list[0];\n    res.value.push(o);\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent, isStart) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let o = {\n        offset: (item.time - begin) / duration,\n        easing: item.easing,\n      };\n      o[key] = item.value;\n      res.value.push(o);\n    }\n  }\n  return res;\n}\n\nexport function transformRotateX(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      rotateX: -list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        rotateX: -item.value,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformRotateY(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      rotateY: -list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        rotateY: -item.value,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\n\nexport function transformRotateZ(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      rotateZ: list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        rotateZ: item.value,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformScale(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let v = {\n      scaleX: list[0][0] * 0.01,\n      scaleY: list[0][1] * 0.01,\n    };\n    if(list[0].length > 2) {\n      v.scaleZ = list[0][2] * 0.01;\n    }\n    res.value.push(v);\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n        prev[2] + (next[2] - prev[2]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let v = {\n        offset: (item.time - begin) / duration,\n        scaleX: item.value[0] * 0.01,\n        scaleY: item.value[1] * 0.01,\n        easing: item.easing,\n      };\n      if(item.value.length > 2) {\n        v.scaleZ = item.value[2] * 0.01;\n      }\n      res.value.push(v);\n    }\n  }\n  return res;\n}\n\nexport function transformPath(list, begin, duration, isEnd) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let v = {\n    };\n    if(isEnd) {\n      v.end = list[0] * 0.01;\n    }\n    else {\n      v.start = list[0] * 0.01;\n    }\n    res.value.push(v);\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return (prev + (next - prev) * percent) * 0.01;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let v = {\n        offset: (item.time - begin) / duration,\n        easing: item.easing,\n      };\n      if(isEnd) {\n        v.end = item.value * 0.01;\n      }\n      else {\n        v.start = item.value * 0.01;\n      }\n      res.value.push(v);\n    }\n  }\n  return res;\n}\n\nexport function transformPoints(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let { vertices, inTangents, outTangents, closed } = list[0];\n    let o = path.parse(vertices, inTangents, outTangents, closed);\n    res.value.push({\n      points: o.points,\n      controls: o.controls,\n    });\n    res.data = o;\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent, isStart) {\n      let { vertices1, inTangents1, outTangents1, closed } = prev;\n      let { vertices2, inTangents2, outTangents2 } = next;\n      let vertices = [], inTangents = [], outTangents = [];\n      for(let i = 0, len = vertices1.len; i < len; i++) {\n        let p = vertices1[i], n = vertices2[i];\n        let pIn = inTangents1[(i + 1) % len], nIn = inTangents2[(i + 1) % len];\n        let pOut = outTangents1[i], nOut = outTangents2[i];\n        // 直线切割或贝塞尔切割\n        if(pIn[0] === 0 && pIn[1] === 0\n          && nIn[0] === 0 && nIn[1] === 0\n          && pOut[0] === 0 && pOut[1] === 0\n          && nOut[0] === 0 && nOut[1] === 0) {\n          vertices.push([\n            p[0] + (n[0] - p[0]) * percent,\n            p[1] + (n[1] - p[1]) * percent\n          ]);\n          inTangents.push([0, 0]);\n          outTangents.push([0, 0]);\n        }\n        else {\n          let arr = [\n            p,\n            pOut,\n            pIn,\n            n,\n          ];\n          if(isStart) {\n            arr.reverse();\n          }\n          let s = sliceBezier(arr, percent);\n          vertices.push(s[3]);\n          if(isStart) {\n            inTangents.push(s[1]);\n            outTangents.push(s[2]);\n          }\n          else {\n            inTangents.push(s[2]);\n            outTangents.push(s[1]);\n          }\n        }\n      }\n      return {\n        vertices,\n        inTangents,\n        outTangents,\n        closed,\n      };\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let { vertices, inTangents, outTangents, closed } = item.value;\n      let o;\n      if(i === 0) {\n        o = path.parse(vertices, inTangents, outTangents, closed);\n        res.data = o;\n      }\n      else {\n        o = path.parse(vertices, inTangents, outTangents, closed, res.data.x1, res.data.y1, res.data.x2, res.data.y2);\n      }\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        points: o.points,\n        controls: o.controls,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformFill(fill, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(fill.color.length === 1) {\n    let first = fill.color[0];\n    let v = [\n      parseInt(first[0] * 255),\n      parseInt(first[1] * 255),\n      parseInt(first[2] * 255),\n      first[3],\n    ];\n    if(fill.opacity[0] < 100) {\n      v[3] *= fill.opacity[0] * 0.01;\n    }\n    res.value.push({\n      fill: [v],\n    });\n  }\n  else {\n    let len = fill.color[0].length;\n    let list = getAreaList(fill.color, begin, duration, function(prev, next, percent) {\n      let arr = [];\n      for(let i = 0; i < len; i++) {\n        arr[i] = prev[i] + (next[i] - prev[i]) * percent;\n      }\n      return arr;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let v = [\n        parseInt(item[0] * 255),\n        parseInt(item[1] * 255),\n        parseInt(item[2] * 255),\n        item[3],\n      ];\n      if(fill.opacity[i] < 100) {\n        v[3] *= fill.opacity[i] * 0.01;\n      }\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        fill: [v],\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformStroke(stroke, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(stroke.color.length === 1) {\n    let first = stroke.color[0];\n    let v = [\n      parseInt(first[0] * 255),\n      parseInt(first[1] * 255),\n      parseInt(first[2] * 255),\n      first[3],\n    ];\n    if(stroke.opacity[0] < 100) {\n      v[3] *= stroke.opacity[0] * 0.01;\n    }\n    res.value.push({\n      stroke: [v],\n    });\n  }\n  else {\n    let list = getAreaList(stroke.color, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let v = [\n        parseInt(item[0] * 255),\n        parseInt(item[1] * 255),\n        parseInt(item[2] * 255),\n        item[3],\n      ];\n      if(stroke.opacity[i] < 100) {\n        v[3] *= stroke.opacity[i] * 0.01;\n      }\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        stroke: [v],\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformStrokeWidth(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      strokeWidth: list,\n    });\n  }\n  else {\n    let len = list[0].length;\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      let arr = [];\n      for(let i = 0; i < len; i++) {\n        arr[i] = prev[i] + (next[i] - prev[i]) * percent;\n      }\n      return arr;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        strokeWidth: item.value,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformLineJoin(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let arr;\n    if(list[0] === 1) {\n      arr = ['miter'];\n    }\n    else if(list[0] === 2) {\n      arr = ['round'];\n    }\n    else {\n      arr = ['bevel'];\n    }\n    res.value.push({\n      strokeLinejoin: arr,\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent, isFirst) {\n      return isFirst ? prev : next;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let arr = [];\n      for(let i = 0, len = item.value.length; i < len; i++) {\n        let item2 = item.value[i];\n        if(item2 === 1) {\n          arr.push('miter');\n        }\n        else if(item2 === 2) {\n          arr.push('round');\n        }\n        else {\n          arr.push('bevel');\n        }\n      }\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        strokeLinejoin: arr,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformMiterLimit(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      strokeWidth: list,\n    });\n  }\n  else {\n    let len = list[0].length;\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      let arr = [];\n      for(let i = 0; i < len; i++) {\n        arr[i] = prev[i] + (next[i] - prev[i]) * percent;\n      }\n      return arr;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        strokeWidth: item.value,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformSize(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n      iterations: 1,\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      size: list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        size: item.value,\n      });\n    }\n  }\n  return res;\n}\n","import {\n  transformOrigin,\n  transformOpacity,\n  transformPosition,\n  transformRotateX,\n  transformRotateY,\n  transformRotateZ,\n  transformScale,\n  transformPath,\n  transformPoints,\n  transformFill,\n  transformStroke,\n  transformStrokeWidth,\n  transformLineJoin,\n  transformMiterLimit,\n  transformSize,\n  translateXY,\n} from './animate';\nimport path from './path';\n\n/**\n * 预解析父级链接，不递归深入children，返回一个普通的div\n * @param data\n * @param library\n * @param start\n * @param duration\n * @param displayStartTime\n * @param offset\n */\nfunction preParse(data, library, start, duration, displayStartTime, offset) {\n  let { name, width, height, inPoint, outPoint, asParent, asChild } = data;\n  let begin = start + offset + displayStartTime;\n  // 图层在工作区外特殊处理，取最近的一帧内容\n  if(inPoint >= begin + duration || outPoint <= begin) {\n    return null;\n  }\n  let res = {\n    name,\n    tagName: 'div',\n    props: {\n      style: {\n        position: 'absolute',\n        width,\n        height,\n        // overflow: 'hidden',\n      },\n    },\n    children: [],\n    animate: [],\n    asParent,\n    asChild,\n  };\n  parseAnimate(res, data, start, duration, displayStartTime, offset, true, false);\n  return res;\n}\n\nfunction parseAnimate(res, data, start, duration, displayStartTime, offset, isDirect, isGeom) {\n  let { width, height, transform } = data;\n  // 分别分析每个变换，过程很相似，当为单帧时需合并到init.style，多帧第一帧需合并且置空\n  let { anchorPoint, opacity, position, position_0, position_1, rotateX, rotateY, rotateZ, scale } = transform;\n  let begin2 = start - offset - displayStartTime;\n  let init = isDirect ? res.props : res.init;\n  if(!isGeom && Array.isArray(anchorPoint) && anchorPoint.length) {\n    let t = transformOrigin(anchorPoint, begin2, duration);\n    let first = t.value[0];\n    let v = first.transformOrigin.split(' ');\n    v[0] = parseFloat(v[0]);\n    v[1] = parseFloat(v[1]);\n    if(v[0] !== width * 0.5 || v[1] !== height * 0.5) {\n      init.style.transformOrigin = first.transformOrigin;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n        easing: first.easing,\n      };\n      // tfo的每个动画需考虑对坐标的影响\n      for(let i = 1, len = t.value.length; i < len; i++) {\n        let item = t.value[i];\n        let tfo = item.transformOrigin.split(' ');\n        tfo[0] = parseFloat(tfo[0]);\n        tfo[1] = parseFloat(tfo[1]);\n        item.left = -tfo[0];\n        item.top = -tfo[1];\n      }\n      res.animate.push(t);\n    }\n    // ae中位置相对于anchor，而不是默认左上角原点，因此有个位置计算\n    if(v[0]) {\n      init.style.left = -v[0];\n    }\n    if(v[1]) {\n      init.style.top = -v[1];\n    }\n  }\n  if(Array.isArray(opacity) && opacity.length) {\n    let t = transformOpacity(opacity, begin2, duration);\n    let first = t.value[0];\n    if(first.opacity !== 1) {\n      init.style.opacity = first.opacity;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n        easing: first.easing,\n      };\n      res.animate.push(t);\n    }\n  }\n  // position要考虑x/y拆开\n  let translateAbbr = true;\n  if(Array.isArray(position_0) && position_0.length > 1) {\n    translateAbbr = false;\n  }\n  if(Array.isArray(position_1) && position_1.length > 1) {\n    translateAbbr = false;\n  }\n  if(Array.isArray(position) && position.length && translateAbbr) {\n    let t = transformPosition(position, begin2, duration);\n    let first = t.value[0];\n    if(first.translatePath) {\n      init.style.translateX = first.translatePath[0];\n      init.style.translateY = first.translatePath[1];\n    }\n    else {\n      if(first.translateX) {\n        init.style.translateX = first.translateX;\n      }\n      if(first.translateY) {\n        init.style.translateY = first.translateY;\n      }\n    }\n    if(t.value.length > 1) {\n      if(!first.translatePath) {\n        t.value[0] = {\n          offset: 0,\n          easing: first.easing,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  else {\n    if(Array.isArray(position_0) && position_0.length) {\n      let t = translateXY(position_0, begin2, duration, 'translateX');\n      let first = t.value[0];\n      if(first.translateX) {\n        init.style.translateX = first.translateX;\n      }\n      if(t.value.length > 1) {\n        t.value[0] = {\n          offset: 0,\n          easing: first.easing,\n        };\n        res.animate.push(t);\n      }\n    }\n    if(Array.isArray(position_1) && position_1.length) {\n      let t = translateXY(position_1, begin2, duration, 'translateY');\n      let first = t.value[0];\n      if(first.translateY) {\n        init.style.translateY = first.translateY;\n      }\n      if(t.value.length > 1) {\n        t.value[0] = {\n          offset: 0,\n          easing: first.easing,\n        };\n        res.animate.push(t);\n      }\n    }\n  }\n  let is3d;\n  if(Array.isArray(rotateX) && rotateX.length) {\n    let t = transformRotateX(rotateX, begin2, duration);\n    let first = t.value[0];\n    if(first.rotateX) {\n      init.style.rotateX = first.rotateX;\n      is3d = true;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n        easing: first.easing,\n      };\n      res.animate.push(t);\n      is3d = true;\n    }\n  }\n  if(Array.isArray(rotateY) && rotateY.length) {\n    let t = transformRotateY(rotateY, begin2, duration);\n    let first = t.value[0];\n    if(first.rotateY) {\n      init.style.rotateY = first.rotateY;\n      is3d = true;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n        easing: first.easing,\n      };\n      res.animate.push(t);\n      is3d = true;\n    }\n  }\n  if(Array.isArray(rotateZ) && rotateZ.length) {\n    let t = transformRotateZ(rotateZ, begin2, duration);\n    let first = t.value[0];\n    if(first.rotateZ) {\n      init.style.rotateZ = first.rotateZ;\n      is3d = true;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n        easing: first.easing,\n      };\n      res.animate.push(t);\n      is3d = true;\n    }\n  }\n  if(is3d) {\n    // path没有width和height，在处理geom时会添加上\n    init.style.perspective = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));\n  }\n  if(Array.isArray(scale) && scale.length) {\n    let t = transformScale(scale, begin2, duration);\n    let first = t.value[0];\n    if(first.scaleX !== 1) {\n      init.style.scaleX = first.scaleX;\n    }\n    if(first.scaleY !== 1) {\n      init.style.scaleY = first.scaleY;\n    }\n    if(first.scaleZ !== 1) {\n      init.style.scaleZ = first.scaleZ;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n        easing: first.easing,\n      };\n      res.animate.push(t);\n    }\n  }\n  return res;\n}\n\n/**\n * 动画和初始init部分转换\n * @param data\n * @param library\n * @param newLib\n * @param start\n * @param duration\n * @param displayStartTime\n * @param offset\n * @param parentLink\n */\nfunction recursion(data, library, newLib, start, duration, displayStartTime, offset, parentLink) {\n  // 作为父级链接不可见时无需导出\n  if(!data.enabled) {\n    return null;\n  }\n  let { name, assetId, startTime, inPoint, outPoint, blendingMode, isMask, isClip } = data;\n  if(assetId === undefined || assetId === null) {\n    return null;\n  }\n  let begin = start + offset + displayStartTime;\n  inPoint += offset + displayStartTime;\n  outPoint += offset + displayStartTime;\n  // 图层在工作区外可忽略\n  if(inPoint >= begin + duration || outPoint <= begin) {\n    return null;\n  }\n  let res = {\n    name,\n  };\n  res.libraryId = parse(library, assetId, newLib, start, duration, displayStartTime, offset + startTime);\n  res.init = {\n    style: {},\n  };\n  // isMask代表是否是遮罩，isClip需在isMask的基础上判断，因为被遮罩层存储isClip值再赋给遮罩层\n  if(isMask) {\n    if(isClip) {\n      res.init.clip = true;\n    }\n    else {\n      res.init.mask = true;\n    }\n  }\n  // 混合模式\n  switch(blendingMode) {\n    case BlendingMode.MULTIPLY:\n      res.init.style.mixBlendMode = 'multiply';\n      break;\n    case BlendingMode.SCREEN:\n      res.init.style.mixBlendMode = 'screen';\n      break;\n    case BlendingMode.OVERLAY:\n      res.init.style.mixBlendMode = 'overlay';\n      break;\n    case BlendingMode.DARKEN:\n      res.init.style.mixBlendMode = 'darken';\n      break;\n    case BlendingMode.COLOR_DODGE:\n      res.init.style.mixBlendMode = 'color-dodge';\n      break;\n    case BlendingMode.COLOR_BURN:\n      res.init.style.mixBlendMode = 'color-burn';\n      break;\n    case BlendingMode.HARD_LIGHT:\n      res.init.style.mixBlendMode = 'hard-light';\n      break;\n    case BlendingMode.SOFT_LIGHT:\n      res.init.style.mixBlendMode = 'soft-light';\n      break;\n    case BlendingMode.DIFFERENCE:\n      res.init.style.mixBlendMode = 'difference';\n      break;\n    case BlendingMode.EXCLUSION:\n      res.init.style.mixBlendMode = 'exclusion';\n      break;\n    case BlendingMode.HUE:\n      res.init.style.mixBlendMode = 'hue';\n      break;\n    case BlendingMode.SATURATION:\n      res.init.style.mixBlendMode = 'saturation';\n      break;\n    case BlendingMode.COLOR:\n      res.init.style.mixBlendMode = 'color';\n      break;\n    case BlendingMode.LUMINOSITY:\n      res.init.style.mixBlendMode = 'luminosity';\n      break;\n  }\n  res.animate = [];\n  // 特殊的visibility动画，如果图层可见在工作区间内，需要有动画，否则可以无视\n  if(inPoint > begin || outPoint < begin + duration) {\n    let v = {\n      value: [],\n      options: {\n        duration,\n        fill: 'forwards',\n        iterations: 1,\n      },\n    };\n    // 开头不可见，默认init的style\n    if(inPoint > begin) {\n      res.init.style.visibility = 'hidden';\n      res.init.style.pointerEvents = 'none';\n      v.value.push({\n        offset: 0,\n      });\n      v.value.push({\n        offset: inPoint / duration,\n        visibility: 'inherit',\n        pointerEvents: 'auto',\n      });\n    }\n    else {\n      v.value.push({\n        offset: 0,\n        visibility: 'inherit',\n        pointerEvents: 'auto',\n      });\n    }\n    // 结尾计算\n    if(outPoint < begin + duration) {\n      // 可能是第一帧但offset不为0，不用担心karas会补充空首帧\n      v.value.push({\n        offset: outPoint / duration,\n        visibility: 'hidden',\n        pointerEvents: 'none',\n      });\n      // 默认不是隐藏需补结束帧为隐藏，否则karas会填补空关键帧\n      if(inPoint <= begin) {\n        v.value.push({\n          offset: 1,\n          visibility: 'hidden',\n          pointerEvents: 'none',\n        });\n      }\n    }\n    else {\n      v.value.push({\n        offset: 1,\n        visibility: 'inherit',\n        pointerEvents: 'auto',\n      });\n    }\n    res.animate.push(v);\n  }\n  parseAnimate(res, data, start, duration, displayStartTime, offset, false, false);\n  // text的位置修正，init的left/top会覆盖props的，多嵌套一层也可以但麻烦\n  let lib = newLib[res.libraryId];\n  if(lib && lib.tagName === 'span') {\n    res.init.style.left = res.init.style.left || 0;\n    res.init.style.left += lib.props.style.left || 0;\n    res.init.style.top = res.init.style.top || 0;\n    res.init.style.top += lib.props.style.top || 0;\n  }\n  // 父级链接塞进父级作为唯一children，有可能父级是递归嵌套的，需到达最里层\n  if(data.hasOwnProperty('asChild')) {\n    let asChild = data.asChild;\n    if(parentLink.hasOwnProperty(asChild)) {\n      let div = JSON.stringify(parentLink[asChild]);\n      div = JSON.parse(div);\n      let target = div;\n      target.asParent = target.asChild = undefined;\n      while(target.children.length) {\n        target = target.children[0];\n        target.asParent = target.asChild = undefined;\n      }\n      target.children.push(res);\n      res = div;\n    }\n  }\n  return res;\n}\n\n/**\n * 静态部分转换，library中无动画的部分\n * @param library\n * @param assetId\n * @param newLib\n * @param start\n * @param duration\n * @param displayStartTime\n * @param offset\n */\nfunction parse(library, assetId, newLib, start, duration, displayStartTime, offset) {\n  let data = library[assetId];\n  let { type, name, src, width, height, children, geom, text } = data;\n  let res = {\n    id: -1, // 占位符\n    name,\n    tagName: type,\n    props: {\n      style: {\n        position: 'absolute',\n        width,\n        height,\n        // overflow: 'hidden',\n      },\n    },\n  };\n  if(type === 'div' && !geom && !text) {\n    res.props.style.overflow = 'hidden';\n  }\n  // 矢量图层特殊解析，添加\n  if(geom) {\n    parseGeom(res, data, start, duration, displayStartTime, offset);\n  }\n  else if(text) {\n    let content = data.content;\n    res.props.style.color = [\n      parseInt(content.fillColor[0] * 255),\n      parseInt(content.fillColor[1] * 255),\n      parseInt(content.fillColor[2] * 255),\n    ];\n    res.props.style.fontFamily = content.fontFamily;\n    res.props.style.fontSize = content.fontSize;\n    // res.props.style.fontStyle = content.fontStyle;\n    // res.props.style.lineHeight = (content.fontSize + content.leading) / content.fontSize;\n    res.props.style.lineHeight = 1.2;\n    res.children = [content.text];\n    // 对齐方式\n    let baselineLocs = content.baselineLocs;\n    let left = 0, right = 0;\n    for(let i = 0, len = baselineLocs.length; i < len; i += 4) {\n      left = Math.min(left, baselineLocs[i]);\n      right = Math.max(right, baselineLocs[i + 2]);\n    }\n    if(content.position) {\n      res.props.style.left = content.position[0];\n      res.props.style.top = content.position[1];\n    }\n    else {\n      if(left) {\n        res.props.style.left = left;\n        res.props.style.width = right - left;\n        res.props.style.textAlign = 'center';\n      }\n      res.props.style.top = -content.fontSize - baselineLocs[1];\n    }\n  }\n  // 图片无children\n  else if(type === 'img') {\n    res.props.src = src;\n  }\n  else if(Array.isArray(children)) {\n    res.children = [];\n    parseChildren(res, children, library, newLib, start, duration, displayStartTime, offset);\n  }\n  res.id = newLib.length;\n  newLib.push(res);\n  return res.id;\n}\n\nfunction parseChildren(res, children, library, newLib, start, duration, displayStartTime, offset) {\n  if(Array.isArray(children)) {\n    // 先一遍解析父级链接，因为父级可能不展示或者只需要父级一层不递归解析父级的children\n    let parentLink = {};\n    for(let i = 0, len = children.length; i < len; i++) {\n      let item = children[i];\n      if(item.hasOwnProperty('asParent')) {\n        parentLink[item.asParent] = preParse(item, library, start, duration, displayStartTime, offset);\n      }\n    }\n    // 因为父级链接可能产生递归嵌套，需要再循环处理一遍parentLink\n    for(let i in parentLink) {\n      if(parentLink.hasOwnProperty(i)) {\n        let item = parentLink[i];\n        let asChild = item.asChild;\n        while(asChild !== undefined && parentLink[asChild]) {\n          let parent = JSON.stringify(parentLink[asChild]);\n          parent = JSON.parse(parent);\n          parent.children.push(item);\n          item = parent;\n          asChild = parent.asChild;\n        }\n        if(item !== parentLink[i]) {\n          parentLink[i] = item;\n        }\n      }\n    }\n    // 再普通解析，遇到父级链接特殊处理\n    for(let i = 0, len = children.length; i < len; i++) {\n      let item = children[i];\n      let temp = recursion(item, library, newLib, start, duration, displayStartTime, offset, parentLink);\n      if(temp) {\n        res.children.push(temp);\n        // ppt应该放在父层，如果有父级链接，则放在其上\n        if(temp.init && temp.init.style && temp.init.style.perspective) {\n          res.props.style.perspective = temp.init.style.perspective || undefined;\n          temp.init.style.perspective = undefined;\n        }\n        if(temp.children && temp.children.length === 1) {\n          let t = temp.children[0];\n          if(t.init && t.init.style && t.init.style.perspective) {\n            temp.props.style.perspective = t.init.style.perspective || undefined;\n            t.init.style.perspective = undefined;\n          }\n        }\n        // 有mask分析mask，且要注意如果有父级链接不能直接存入当前children，要下钻\n        if(item.mask && item.mask.enabled) {\n          let m = parseMask(item, temp, start, duration, displayStartTime, offset);\n          let target = res;\n          while(temp.children && temp.children.length === 1) {\n            target = temp;\n            temp = temp.children[0];\n          }\n          target.children.push(m);\n          // 特殊的地方，被遮罩的可能有init样式，mask需同等赋值\n          let style = target.children[0].init.style;\n          if(style) {\n            for(let i in style) {\n              if(style.hasOwnProperty(i) && {\n                'scaleX': true,\n                'scaleY': true,\n              }.hasOwnProperty(i)) {\n                m.props.style[i] = style[i];\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n/**\n * 形状图层特殊的直接为其生成一个内联children\n * @param res\n * @param data\n * @param start\n * @param duration\n * @param displayStartTime\n * @param offset\n */\nfunction parseGeom(res, data, start, duration, displayStartTime, offset) {\n  let { shape: { content, fill, gFill, stroke, transform }, trim } = data;\n  let begin2 = start - offset - displayStartTime;\n  // 矢量可能有多个，但样式共用一个\n  let children = [];\n  let len = content.length;\n  if(!len) {\n    return;\n  }\n  // 由于动画的特殊性，无法直接用矢量标签，需嵌套一个中间层div\n  let child = {\n    tagName: 'div',\n    props: {\n      style: {\n        position: 'absolute',\n      },\n    },\n    children,\n    animate: [],\n  };\n  for(let i = 0, len = content.length; i < len; i++) {\n    let item = content[i];\n    let { type, direction, size, position, roundness, points } = item;\n    let f;\n    // 由于动画的特殊性，无法直接用矢量标签，需嵌套一个中间层div\n    let $geom = {\n      tagName: '$polyline',\n      props: {\n        style: {\n          position: 'absolute',\n        },\n      },\n      animate: [],\n    };\n    children.push($geom);\n    // 分类处理矢量\n    if(type === 'rect' || type === 'ellipse') {\n      let t = transformSize(size, begin2, duration);\n      let first = t.value[0];\n      $geom.props.style.width = first.size[0];\n      $geom.props.style.height = first.size[1];\n      if(t.value.length > 1) {\n        t.value[0] = {\n          offset: 0,\n        };\n        // 用缩放代替尺寸变化\n        for(let i = 1, len = t.value.length; i < len; i++) {\n          let item = t.value[i];\n          let size = item.size;\n          item.size = undefined;\n          item.scaleX = size[0] / first.size[0];\n          item.scaleY = size[1] / first.size[1];\n        }\n        $geom.animate.push(t);\n      }\n      if(type === 'rect') {\n        let o = path.rect2polyline(first.size[0], first.size[1], roundness[0]);\n        $geom.props.points = o.points;\n        $geom.props.controls = o.controls;\n      }\n      else if(type === 'ellipse') {\n        let o = path.ellipse2polyline();\n        $geom.props.points = o.points;\n        $geom.props.controls = o.controls;\n      }\n    }\n    else if(type === 'star') {\n      // TODO\n    }\n    else if(type === 'path') {\n      let t = transformPoints(points, begin2, duration);\n      let d = t.data;\n      // path特殊没尺寸，3d等计算ppt需赋值\n      $geom.props.style.width = data.shape.width = d.width;\n      $geom.props.style.height = data.shape.height = d.height;\n      // path的特殊位置计算，因为ae中尺寸为0\n      $geom.props.style.left = d.x2;\n      $geom.props.style.top = d.y2;\n      t.data = undefined;\n      let first = t.value[0];\n      $geom.props.points = first.points;\n      $geom.props.controls = first.controls;\n      if(t.value.length > 1) {\n        t.value[0] = {\n          offset: 0,\n        };\n        $geom.animate.push(t);\n      }\n    }\n    // path没有position\n    if(position && position.length) {\n      let t = transformPosition(position, begin2, duration);\n      let first = t.value[0];\n      $geom.props.style.translateX = first.translateX;\n      $geom.props.style.translateY = first.translateY;\n      if(t.value.length > 1) {\n        t.value[0] = {\n          offset: 0,\n        };\n        for(let i = 1; i < t.value.length; i++) {\n          let item = t.value[i];\n          item.translateX -= first.translateX;\n          item.translateY -= first.translateY;\n        }\n        $geom.animate.push(t);\n      }\n    }\n    if(fill && fill.rule === 2 || gFill && gFill.rule === 2) {\n      $geom.props.style.fillRule = 'evenodd';\n    }\n    // geom内嵌的transform单独分析，都作用在中间层div上，anchorPoint比较特殊\n    let { anchorPoint } = transform;\n    if(Array.isArray(anchorPoint) && anchorPoint.length) {\n      let t = transformOrigin(anchorPoint, begin2, duration);\n      let first = t.value[0];\n      let v = first.transformOrigin.split(' ');\n      v[0] = parseFloat(v[0]);\n      v[1] = parseFloat(v[1]);\n      /**\n       * path很特殊，原始没有宽高，ae是锚点0,0相对于自身左上角原点，定位则是锚点来进行定位\n       * 需记录最初的位置，发生锚点动画时，其会干扰left/top，同步形成位置动画\n       */\n      if(type === 'path') {\n        let left = $geom.props.style.left;\n        let top = $geom.props.style.top;\n        $geom.props.style.left -= v[0];\n        $geom.props.style.top -= v[1];\n        let w = $geom.props.style.width;\n        let h = $geom.props.style.height;\n        v[0] += w * 0.5;\n        v[1] += h * 0.5;\n        if(v[0] !== w * 0.5 || v[1] !== h * 0.5) {\n          $geom.props.style.transformOrigin = first.transformOrigin;\n        }\n        if(t.value.length > 1) {\n          if(first.offset === 0) {\n            t.value[0] = {\n              offset: 0,\n            };\n          }\n          // tfo的每个动画需考虑对坐标的影响\n          for(let i = 1, len = t.value.length; i < len; i++) {\n            let item = t.value[i];\n            let tfo = item.transformOrigin.split(' ');\n            tfo[0] = parseFloat(tfo[0]);\n            tfo[1] = parseFloat(tfo[1]);\n            item.left = left - tfo[0];\n            item.top = top - tfo[1];\n          }\n          $geom.animate.push(t);\n        }\n      }\n      else {\n        // tfo中心判断，加上尺寸*0.5\n        v[0] += $geom.props.style.width * 0.5;\n        v[1] += $geom.props.style.height * 0.5;\n        if(v[0] !== $geom.props.style.width * 0.5 || v[1] !== $geom.props.style.height * 0.5) {\n          $geom.props.style.transformOrigin = first.transformOrigin;\n        }\n        if(t.value.length > 1) {\n          if(first.offset === 0) {\n            t.value[0] = {\n              offset: 0,\n            };\n          }\n          $geom.animate.push(t);\n        }\n        if(v[0]) {\n          $geom.props.style.left = -v[0];\n        }\n        if(v[1]) {\n          $geom.props.style.top = -v[1];\n        }\n      }\n    }\n    parseAnimate(child, data.shape, start, duration, offset, true, true);\n    // gradient需要根据transformOrigin来计算\n    if(gFill) {\n      let transformOrigin = $geom.props.style.transformOrigin;\n      let w = $geom.props.style.width, h = $geom.props.style.height;\n      let cx, cy;\n      if(transformOrigin) {\n        transformOrigin = transformOrigin.split(' ');\n        cx = parseFloat(transformOrigin[0]);\n        cy = parseFloat(transformOrigin[1]);\n      }\n      else {\n        cx = w * 0.5;\n        cy = h * 0.5;\n      }\n      let { type, start, end } = gFill;\n      if(type === 1) {\n        let x0 = $geom.props.style.translateX || 0, y0 = $geom.props.style.translateY || 0;\n        let x1 = start[0] + cx, y1 = start[1] + cy;\n        let x2 = end[0] + cx, y2 = end[1] + cy;\n        f = `linearGradient(${(x1 - x0) / w} ${(y1 - y0) / h} ${(x2 - x0) / w} ${(y2 - y0)/ h}, #FFF, #000)`;\n      }\n      else if(type === 2) {\n        let x0 = $geom.props.style.translateX || 0, y0 = $geom.props.style.translateY || 0;\n        let x1 = start[0] + cx, y1 = start[1] + cy;\n        let x2 = end[0] + cx, y2 = end[1] + cy;\n        f = `radialGradient(${(x1 - x0) / w} ${(y1 - y0) / h} ${(x2 - x0) / w} ${(y2 - y0)/ h}, #FFF, #000)`;\n      }\n      $geom.props.style.fill = [f];\n    }\n    // trimPath裁剪动画或属性\n    if(trim && trim.hasOwnProperty('start') && trim.hasOwnProperty('end')) {\n      let start = trim.start, end = trim.end;\n      if(start.length > 1) {\n        let t = transformPath(start, begin2, duration, false);\n        let first = t.value[0];\n        if(first.start !== 0) {\n          $geom.props.start = first.start;\n        }\n        if(t.value.length > 1) {\n          if(first.offset === 0) {\n            t.value[0] = {\n              offset: 0,\n            };\n          }\n          $geom.animate.push(t);\n        }\n      }\n      else {\n        $geom.props.start = start[0] * 0.01;\n      }\n      if(end.length > 1) {\n        let t = transformPath(end, begin2, duration, true);\n        let first = t.value[0];\n        if(first.end !== 0) {\n          $geom.props.end = first.end;\n        }\n        if(t.value.length > 1) {\n          if(first.offset === 0) {\n            t.value[0] = {\n              offset: 0,\n            };\n          }\n          $geom.animate.push(t);\n        }\n      }\n      else {\n        $geom.props.end = end[0] * 0.01;\n      }\n    }\n  }\n  if(fill && Array.isArray(fill.color) && fill.color.length) {\n    let t = transformFill(fill, begin2, duration);\n    let first = t.value[0];\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.fill = first.fill;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      for(let i = 0; i < len; i++) {\n        children[i].animate.push(t);\n      }\n    }\n  }\n  if(stroke && Array.isArray(stroke.color) && stroke.color.length) {\n    let t = transformStroke(stroke, begin2, duration);\n    let first = t.value[0];\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.stroke = first.stroke;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      for(let i = 0; i < len; i++) {\n        children[i].animate.push(t);\n      }\n    }\n  }\n  if(stroke && Array.isArray(stroke.width) && stroke.width.length) {\n    let t = transformStrokeWidth(stroke.width, begin2, duration);\n    let first = t.value[0];\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.strokeWidth = first.strokeWidth;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      for(let i = 0; i < len; i++) {\n        children[i].animate.push(t);\n      }\n    }\n  }\n  if(stroke && Array.isArray(stroke.lineJoin) && stroke.lineJoin.length) {\n    let t = transformLineJoin(stroke.lineJoin, begin2, duration);\n    let first = t.value[0];\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.strokeLineJoin = first.strokeLineJoin;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      for(let i = 0; i < len; i++) {\n        children[i].animate.push(t);\n      }\n    }\n  }\n  if(stroke && Array.isArray(stroke.strokeMiterlimit) && stroke.strokeMiterlimit.length) {\n    let t = transformMiterLimit(stroke.strokeMiterlimit, begin2, duration);\n    let first = t.value[0];\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.strokeMiterlimit = first.strokeMiterlimit;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      for(let i = 0; i < len; i++) {\n        children[i].animate.push(t);\n      }\n    }\n  }\n  if(stroke && stroke.dashes) {\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.strokeDasharray = [stroke.dashes];\n    }\n  }\n  if(!stroke) {\n    for(let i = 0; i < len; i++) {\n      children[i].props.style.strokeWidth = [0];\n    }\n  }\n  res.children = [child];\n}\n\nfunction parseMask(data, target, start, duration, displayStartTime, offset) {\n  // $.ae2karas.log(data);\n  // $.ae2karas.log(target);\n  // 会出现父级链接特殊情况，此时遮罩应该是其唯一children\n  if(target.children && target.children.length === 1) {\n    target = target.children[0];\n  }\n  let targetProps = target.init;\n  let left = targetProps.style.left || 0;\n  let top = targetProps.style.top || 0;\n  let res = {\n    tagName: '$polyline',\n    props: {\n      style: {\n        position: 'absolute',\n        fill: '#FFF',\n      },\n    },\n    animate: [],\n  };\n  let { width, height, mask: { list: { points, opacity }, mode, inverted } } = data;\n  // 相加之外都是相减\n  if(mode === MaskMode.ADD) {\n    if(inverted) {\n      res.props.clip = true;\n    }\n    else {\n      res.props.mask = true;\n    }\n  }\n  else {\n    if(inverted) {\n      res.props.mask = true;\n    }\n    else {\n      res.props.clip = true;\n    }\n  }\n  // 样式和target一致，只有位置信息需要\n  let style = targetProps.style;\n  for(let i in style) {\n    if(style.hasOwnProperty(i) && ['left', 'top', 'translateX', 'translateY'].indexOf(i) > -1) {\n      res.props.style[i] = style[i];\n    }\n  }\n  // 要显示mask，可能会被target同化\n  res.props.style.visibility = undefined;\n  res.props.style.pointerEvents = undefined;\n  // mask的2个动画，points和opacity\n  let o = {};\n  let begin2 = start - offset - displayStartTime;\n  if(Array.isArray(points) && points.length) {\n    let t = transformPoints(points, begin2, duration);\n    o = t.data;\n    res.props.style.width = o.width;\n    res.props.style.height = o.height;\n    t.data = undefined;\n    let first = t.value[0];\n    res.props.points = first.points;\n    res.props.controls = first.controls;\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      res.animate.push(t);\n    }\n  }\n  else {\n    return res;\n  }\n  if(Array.isArray(opacity) && opacity.length) {\n    let t = transformOpacity(opacity, begin2, duration);\n    let first = t.value[0];\n    if(first.opacity !== 1) {\n      res.props.style.opacity = first.opacity;\n    }\n    if(t.value.length > 1) {\n      t.value[0] = {\n        offset: 0,\n      };\n      res.animate.push(t);\n    }\n  }\n  // 获取对象锚点，mask的锚点需保持相同\n  let transformOrigin = targetProps.style.transformOrigin;\n  let cx = width * 0.5, cy = height * 0.5;\n  if(transformOrigin) {\n    let v = transformOrigin.split(' ');\n    cx = parseFloat(v[0]);\n    cy = parseFloat(v[1]);\n  }\n  // 位置和锚点保持和mask相同，由于points可能不是0，0开始，需计算偏移\n  res.props.style.transformOrigin = (cx - o.x2) + ' ' + (cy - o.y2);\n  res.props.style.left = left + o.x2;\n  res.props.style.top = top + o.y2;\n  return res;\n}\n\nlet uuid = 0;\n\nexport default function(data) {\n  $.ae2karas.error('convert');\n  let { workAreaStart, workAreaDuration, result, library } = data;\n  let { name, width, height, children, displayStartTime } = result;\n  let newLib = [];\n  let res = {\n    uuid: uuid++,\n    name,\n    tagName: 'div',\n    props: {\n      style: {\n        position: 'absolute',\n        width,\n        height,\n        // overflow: 'hidden',\n      },\n    },\n    children: [],\n    library: newLib,\n    abbr: false,\n  };\n  parseChildren(res, children, library, newLib, workAreaStart, workAreaDuration, displayStartTime, 0);\n  return res;\n}\n","import enums from './enums';\nimport parse from './parse/index';\nimport convert from './convert/index';\n\nconst { ES_TYPE, EVENT } = enums;\n\nlet ae2karas = $.ae2karas = $.ae2karas || {};\n\nArray.isArray = Array.isArray || function(arr) {\n  return arr instanceof Array;\n};\n\nae2karas.dispatch = (function() {\n  let xLib;\n  try {\n    xLib = new ExternalObject('lib:PlugPlugExternalObject');\n  } catch(e) {\n    alert('Missing ExternalObject: ');\n  }\n  return function(type, data) {\n    if(xLib) {\n      if(data && data instanceof Object) {\n        data = JSON.stringify(data);\n      }\n      else if(data === undefined) {\n        data = 'undefined';\n      }\n      else if(data === null) {\n        data = 'null';\n      }\n      else if(data === true) {\n        data = 'true';\n      }\n      else if(data === false) {\n        data = 'false';\n      }\n      // if(typeof data === 'number') {\n      //   data = data.toString();\n      // }\n      var eventObj = new CSXSEvent();\n      eventObj.type = type;\n      eventObj.data = data;\n      eventObj.dispatch();\n    }\n  };\n})();\n\nae2karas.log = function(s) {\n  $.ae2karas.dispatch(enums.EVENT.LOG, s);\n};\n\nae2karas.warn = function(s) {\n  $.ae2karas.dispatch(enums.EVENT.WARN, s);\n};\n\nae2karas.error = function(s) {\n  $.ae2karas.dispatch(enums.EVENT.ERROR, s);\n};\n\nfunction getItemType(item) {\n  if(item instanceof CompItem) {\n    return ES_TYPE.COMP_ITEM;\n  }\n  if(item instanceof FolderItem) {\n    return ES_TYPE.FOLDER_ITEM;\n  }\n  if(item instanceof FootageItem) {\n    return ES_TYPE.FOOTAGE_ITEM;\n  }\n  return ES_TYPE.UNKNOWN;\n}\n\nae2karas.getCompositions = function() {\n  let folderItem = app.project;\n  let list = [];\n  // 所有的合成都在app.project下，包含文件夹递归树的\n  for(let i = 1; i <= folderItem.numItems; i++) {\n    let compItem = folderItem.item(i);\n    let type = getItemType(compItem);\n    if(type === ES_TYPE.COMP_ITEM) {\n      list.push({\n        id: compItem.id,\n        name: compItem.name,\n        width: compItem.width,\n        height: compItem.height,\n        type,\n      });\n    }\n  }\n  $.ae2karas.dispatch(EVENT.INIT, list);\n};\n\nfunction findCompositionById(id) {\n  for(let i = 1; i <= app.project.numItems; i++) {\n    const compItem = app.project.item(i);\n    if(compItem.id === id) {\n      return compItem;\n    }\n  }\n  return null;\n}\n\nae2karas.convert = function(id) {\n  $.ae2karas.error('start');\n  let composition = findCompositionById(id);\n  if(!composition) {\n    $.ae2karas.error('error: no composition');\n    $.ae2karas.dispatch(enums.EVENT.CANCEL);\n    return;\n  }\n  // 递归遍历分析合成对象，转换ae的图层为普通js对象，留给后续转换karas用\n  let res = parse(composition);\n  $.ae2karas.dispatch(enums.EVENT.FINISH, convert(res));\n  // 结束后才能删除临时生成的导出psd的合成和渲染队列\n  $.ae2karas.delTemp();\n  $.ae2karas.error('finish');\n};\n\nlet list = [];\nae2karas.addTemp = function(o) {\n  list.push(o);\n};\nae2karas.delTemp = function() {\n  while(list.length) {\n    list.pop().remove();\n  }\n};\n\nae2karas.export = function(data) {\n  $.ae2karas.error('export');\n  $.ae2karas.log(data);\n  let file = File.saveDialog();\n  if(!file) {\n    return;\n  }\n  let name = file.fsName;\n  if(!/\\.json$/.test(name)) {\n    name += '.json';\n  }\n  let f = new File(name);\n  f.open('w');\n  f.encoding = 'utf-8';\n  f.write(data);\n  f.close();\n  return true;\n};\n"],"names":["ES_TYPE","FOLDER_ITEM","FOOTAGE_ITEM","COMP_ITEM","UNKNOWN","EVENT","INIT","LOG","WARN","ERROR","FINISH","CANCEL","ADD_TEMP","DEL_TEMP","LAYER_TRANSFORM","VECTOR_TRANSFORM","MASK_TRANSFORM","getPropertyValues","prop","matchName","noEasing","numKeys","arr","i","v1","keyValue","v2","c1","keyOutSpatialTangent","c2","keyInSpatialTangent","x1","y1","x2","y2","p1","p2","Math","abs","o","time","keyTime","value","easing","getEasing","push","k","b","r","is1","is2","start","end","t1","t2","e1","keyOutTemporalEase","e2","keyInTemporalEase","influence","indexOf","avSpeedX","avSpeedY","avSpeed","sqrt","speed","undefined","transformLayer","res","numProperties","item","property","enabled","hasOwnProperty","transformVector","transformMask","transformGeom","group","content","transform","name","rect","ellipse","star","path","stroke","fill","gFill","type","direction","size","position","roundness","starType","points","innerRadius","outerRadius","innerRoundness","outerRoundness","rotation","color","opacity","width","lineCap","lineJoin","miterLimit","dashes","d","g","canSetExpression","j","exec","length","v","len","rule","library","shape","trim","psd2png","source","psd","helperSequenceComp","app","project","items","addComp","height","layers","add","$","ae2karas","addTemp","renderQueue","outputModule","applyTemplate","fileName","file","File","exists","remove","onStatusChanged","status","RQItemStatus","DONE","bug","rename","render","uuid","recursion","composition","displayStartTime","duration","error","hasSolo","solo","asParent","asChild","parent","index","children","outer","isTrackMatte","item2","parseLayer","isClip","last","isMask","reverse","layer","startTime","inPoint","outPoint","blendingMode","trackMatteType","TrackMatteType","ALPHA_INVERTED","warn","geom","txt","vector","mask","text","id","assetId","asset","FootageItem","src","fsName","test","replace","newName","hasExist","CompItem","maskMode","MaskMode","NONE","list","mode","inverted","fillColor","font","fontFamily","fontStyle","fontSize","leading","baselineLocs","boxText","boxTextSize","boxTextPos","workAreaStart","workAreaDuration","log","result","parse","vertices","inTangents","outTangents","closed","it","ot","max","min","w","h","pts","cts","x","y","unshift","slice","controls","rect2polyline","ellipse2polyline","rx","ry","getAreaList","begin","reducer","startIndex","endIndex","first","Array","isArray","next","percent","sliceBezier","prev","t","p3","p4","x3","y3","x12","y12","x23","y23","x123","y123","x4","y4","x34","y34","x234","y234","x1234","y1234","transformOrigin","options","iterations","offset","transformOpacity","transformPosition","translateX","translateY","isStart","translatePath","translateXY","key","transformRotateX","rotateX","transformRotateY","rotateY","transformRotateZ","rotateZ","transformScale","scaleX","scaleY","scaleZ","transformPath","isEnd","transformPoints","data","vertices1","inTangents1","outTangents1","vertices2","inTangents2","outTangents2","p","n","pIn","nIn","pOut","nOut","s","transformFill","parseInt","transformStroke","transformStrokeWidth","strokeWidth","transformLineJoin","strokeLinejoin","isFirst","transformMiterLimit","transformSize","preParse","tagName","props","style","animate","parseAnimate","isDirect","isGeom","anchorPoint","position_0","position_1","scale","begin2","init","split","parseFloat","tfo","left","top","translateAbbr","is3d","perspective","pow","newLib","parentLink","libraryId","clip","BlendingMode","MULTIPLY","mixBlendMode","SCREEN","OVERLAY","DARKEN","COLOR_DODGE","COLOR_BURN","HARD_LIGHT","SOFT_LIGHT","DIFFERENCE","EXCLUSION","HUE","SATURATION","COLOR","LUMINOSITY","visibility","pointerEvents","lib","div","JSON","stringify","target","overflow","parseGeom","lineHeight","right","textAlign","parseChildren","temp","m","parseMask","child","f","$geom","fillRule","cx","cy","x0","y0","strokeLineJoin","strokeMiterlimit","strokeDasharray","targetProps","ADD","abbr","enums","dispatch","xLib","ExternalObject","e","alert","Object","eventObj","CSXSEvent","getItemType","FolderItem","getCompositions","folderItem","numItems","compItem","findCompositionById","convert","delTemp","pop","saveDialog","open","encoding","write","close"],"mappings":"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"}