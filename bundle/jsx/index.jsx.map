{"version":3,"file":"index.jsx","sources":["../../es/enums.js","../../es/parse/transform.js","../../es/parse/vector.js","../../es/render.js","../../es/parse/index.js","../../es/convert/animate.js","../../es/convert/path.js","../../es/convert/index.js","../../es/index.js"],"sourcesContent":["export default {\n  ES_TYPE: {\n    FOLDER_ITEM: 'FolderItem',\n    FOOTAGE_ITEM: 'FootageItem',\n    COMP_ITEM: 'CompItem',\n  },\n  EVENT: {\n    INIT: 'ae2karas:init',\n    LOG: 'ae2karas:log',\n    WARN: 'ae2karas:warn',\n    ERROR: 'ae2karas:error',\n    FINISH: 'ae2karas:finish',\n    ADD_TEMP: 'ae2karas:addTemp',\n    DEL_TEMP: 'ae2karas:delTemp',\n  },\n};\n","const LAYER_TRANSFORM = {\n  'ADBE Anchor Point': 'anchorPoint',\n  'ADBE Position': 'position',\n  'ADBE Position_0': 'position_0',\n  'ADBE Position_1': 'position_1',\n  'ADBE Position_2': 'position_2',\n  'ADBE Scale': 'scale',\n  'ADBE Orientation': 'orientation',\n  'ADBE Rotate X': 'rotateX',\n  'ADBE Rotate Y': 'rotateY',\n  'ADBE Rotate Z': 'rotateZ',\n  'ADBE Opacity': 'opacity',\n};\n\nconst VECTOR_TRANSFORM = {\n  'ADBE Vector Anchor': 'anchorPoint',\n  'ADBE Vector Position': 'position',\n  'ADBE Vector Scale': 'scale',\n  'ADBE Vector Skew': 'skew',\n  'ADBE Vector Skew Axis': 'skewAxis',\n  'ADBE Vector Rotation': 'rotation',\n  'ADBE Vector Group Opacity': 'opacity',\n  'ADBE Vector Trim Start': 'start',\n  'ADBE Vector Trim End': 'end',\n};\n\nfunction getPropertyValues(prop) {\n  let { numKeys } = prop;\n  // 根据关键帧数量，2+帧是普通变化，1帧等同于0帧value\n  if(numKeys && numKeys > 1) {\n    let arr = [];\n    for(let i = 1; i <= numKeys; i++) {\n      arr.push({\n        time: prop.keyTime(i) * 1000,\n        value: prop.keyValue(i),\n        easing: i === numKeys ? undefined : getEasing(prop, i, i + 1),\n      });\n    }\n    return arr;\n  }\n  else if(numKeys && numKeys > 0) {\n    return [prop.keyValue(1)];\n  }\n  else {\n    return [prop.value];\n  }\n}\n\n/**\n * https://www.zhihu.com/question/24404065\n * 柄点1的X值 = 关键帧1的影响值/100\n * 柄点1的Y值 = 关键帧1的输出速度/两关键帧平均速度*柄点1的X值\n * 柄点2的X值 = 1 - 关键帧2的影响值/100\n * 柄点2的Y值 = 1 - 关键帧2的输入速度/两关键帧平均速度*柄点2的X值\n * @param prop\n * @param start\n * @param end\n */\nfunction getEasing(prop, start, end) {\n  let t1 = prop.keyTime(start), t2 = prop.keyTime(end);\n  let v1 = prop.keyValue(start), v2 = prop.keyValue(end);\n  let e1 = prop.keyOutTemporalEase(start)[0], e2 = prop.keyInTemporalEase(end)[0];\n  let x1 = e1.influence * 0.01, x2 = 1 - e2.influence * 0.01;\n  let y1, y2;\n  let matchName = prop.matchName;\n  if([\n    'ADBE Anchor Point', 'ADBE Position',\n    'ADBE Vector Anchor', 'ADBE Vector Position',\n    'ADBE Vector Scale', 'ADBE Vector Skew'].indexOf(matchName) > -1) {\n    let avSpeedX = Math.abs(v2[0] - v1[0]) / (t2 - t1);\n    let avSpeedY = Math.abs(v2[1] - v1[1]) / (t2 - t1);\n    let avSpeed = Math.sqrt(avSpeedX * avSpeedX + avSpeedY * avSpeedY);\n    y1 = x1 * e1.speed / avSpeed;\n    y2 = 1 - (1 - x2) * e2.speed / avSpeed;\n  }\n  else {\n    let avSpeedX = Math.abs(v2 - v1) / (t2 - t1);\n    let avSpeedY = Math.abs(v2 - v1) / (t2 - t1);\n    let avSpeed = Math.sqrt(avSpeedX * avSpeedX + avSpeedY * avSpeedY);\n    y1 = x1 * e1.speed / avSpeed;\n    y2 = 1 - (1 - x2) * e2.speed / avSpeed;\n  }\n  if(x1 === y1 && x2 === y2 || y1 === undefined || y2 === undefined) {\n    return;\n  }\n  return [x1, y1, x2, y2];\n}\n\nexport function transformLayer(prop) {\n  let res = {};\n  for(let i = 1; prop && i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(LAYER_TRANSFORM.hasOwnProperty(matchName)) {\n        res[LAYER_TRANSFORM[matchName]] = getPropertyValues(item);\n      }\n    }\n  }\n  return res;\n}\n\nexport function transformVector(prop) {\n  let res = {};\n  for(let i = 1; prop && i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(VECTOR_TRANSFORM.hasOwnProperty(matchName)) {\n        res[VECTOR_TRANSFORM[matchName]] = getPropertyValues(item);\n      }\n    }\n  }\n  return res;\n}\n","import { transformVector } from './transform';\n\nfunction group(prop) {\n  let res = {};\n  // 这里是矩形1层，主要关注Groups属性即可，blendMode暂时无视，transform被上钻2层提前\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vectors Group':\n          res.content = content(item);\n          break;\n        case 'ADBE Vector Transform Group':\n          // 奇怪的地方，显示应该下钻2层到如rect同级，可实际提前了\n          res.transform = transformVector(item);\n          break;\n      }\n    }\n  }\n  res.content.transform = res.transform;\n  return res.content;\n}\n\nfunction content(prop) {\n  // 矩形1下面会多出一层内容层看不见，就是本层，其下面则是可视的子属性层\n  let res = {\n    name: prop.name,\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape - Rect':\n          res.content = rect(item);\n          break;\n        case 'ADBE Vector Shape - Ellipse':\n          res.content = ellipse(item);\n          break;\n        case 'ADBE Vector Shape - Star':\n          res.content = star(item);\n          break;\n        case 'ADBE Vector Shape - Group':\n          res.content = path(item);\n          break;\n        case 'ADBE Vector Graphic - Stroke':\n          res.stroke = stroke(item);\n          break;\n        case 'ADBE Vector Graphic - Fill':\n          res.fill = fill(item);\n          break;\n        case 'ADBE Vector Graphic - G-Fill':\n          res.gfill = gFill(item);\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction rect(prop) {\n  // 矩形路径层\n  let res = {\n    type: 'rect',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Rect Size':\n          res.size = item.value;\n          break;\n        case 'ADBE Vector Rect Position':\n          res.position = item.value;\n          break;\n        case 'ADBE Vector Rect Roundness':\n          res.roundness = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction ellipse(prop) {\n  let res = {\n    type: 'ellipse',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Ellipse Size':\n          res.size = item.value;\n          break;\n        case 'ADBE Vector Ellipse Position':\n          res.position = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction star(prop) {\n  let res = {\n    type: 'star',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Star Type':\n          res.starType = item.value;\n          break;\n        case 'ADBE Vector Star Points':\n          res.points = item.value;\n          break;\n        case 'ADBE Vector Star Position':\n          res.position = item.value;\n          break;\n        case 'ADBE Vector Star Inner Radius':\n          res.innerRadius = item.value;\n          break;\n        case 'ADBE Vector Star Outer Radius':\n          res.outerRadius = item.value;\n          break;\n        case 'ADBE Vector Star Inner Roundess':\n          res.innerRoundness = item.value;\n          break;\n        case 'ADBE Vector Star Outer Roundess':\n          res.outerRoundness = item.value;\n          break;\n        case 'ADBE Vector Star Rotation':\n          res.rotation = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction stroke(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Stroke Color':\n          res.color = item.value;\n          break;\n        case 'ADBE Vector Stroke Opacity':\n          res.opacity = item.value;\n          break;\n        case 'ADBE Vector Stroke Width':\n          res.width = item.value;\n          break;\n        case 'ADBE Vector Line Cap':\n          res.lineCap = item.value;\n          break;\n        case 'ADBE Vector Stroke Line Join':\n          res.lineJoin = item.value;\n          break;\n        case 'ADBE Vector Stroke Miter Limit':\n          res.miterLimit = item.value;\n          break;\n        // case 'ADBE Vector Stroke Dashes':\n        //   res.dashes = dash(item);\n        //   break;\n      }\n    }\n  }\n  // 特殊的获取虚线样式\n  let dashes = prop.property('Dashes');\n  if(dashes) {\n    let d = [];\n    let g = [];\n    for(let i = 1; i <= dashes.numProperties; i++) {\n      let item = dashes.property(i);\n      if(item && item.enabled) {\n        let matchName = item.matchName;\n        if(item.canSetExpression) {\n          if(matchName.indexOf('ADBE Vector Stroke Dash') > -1) {\n            let j = /\\d+/.exec(matchName);\n            d[j[0] - 1] = item.value;\n          }\n          else if (matchName.indexOf('ADBE Vector Stroke Gap') > -1) {\n            let j = /\\d+/.exec(matchName);\n            g[j[0] - 1] = item.value;\n          }\n        }\n      }\n    }\n    if(d.length) {\n      let v = [];\n      for(let i = 0, len = d.length; i < len; i++) {\n        v.push(d[i]);\n        if(g[i] === undefined) {\n          v.push(d[i]);\n        }\n        else {\n          v.push(g[i]);\n        }\n      }\n      res.dashes = v;\n    }\n  }\n  return res;\n}\n\nfunction path(prop) {\n  let res = {\n    type: 'path',\n  };\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Shape Direction':\n          res.direction = item.value;\n          break;\n        case 'ADBE Vector Shape':\n          res.points = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction fill(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Fill Rule':\n          res.rule = item.value;\n          break;\n        case 'ADBE Vector Fill Color':\n          res.color = item.value;\n          break;\n        case 'ADBE Vector Fill Opacity':\n          res.opacity = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nfunction gFill(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Composite Order':\n          break;\n        case 'ADBE Vector Fill Rule':\n          res.rule = item.value;\n          break;\n        case 'ADBE Vector Grad Type':\n          res.type = item.value;\n          break;\n        case 'ADBE Vector Grad Start Pt':\n          res.start = item.value;\n          break;\n        case 'ADBE Vector Grad End Pt':\n          res.end = item.value;\n          break;\n        case 'ADBE Vector Grad Colors':\n          //\n          break;\n        case 'ADBE Vector Fill Opacity':\n          res.opacity = item.value;\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nexport default function(prop, library) {\n  let res = {};\n  // 这里是内容层，一般只有1个属性，如矩形1\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Vector Group':\n          res.shape = group(item, library);\n          break;\n        case 'ADBE Vector Filter - Trim':\n          res.trim = transformVector(item);\n          break;\n      }\n    }\n  }\n  return res;\n};\n","export default {\n  psd2png(source, psd, path, name) {\n    let helperSequenceComp = app.project.items.addComp('tempConverterComp', source.width, source.height, 1, 1, 1);\n    helperSequenceComp.layers.add(source);\n    $.ae2karas.addTemp(helperSequenceComp);\n\n    let item = app.project.renderQueue.items.add(helperSequenceComp);\n    $.ae2karas.addTemp(item);\n\n    let outputModule = item.outputModule(1);\n    outputModule.applyTemplate(\"_HIDDEN X-Factor 8 Premul\");\n    let fileName = path + name;\n    let file = new File(fileName);\n    if(file.exists) {\n      file.remove();\n    }\n    outputModule.file = new File(fileName);\n\n    item.onStatusChanged = function() {\n      // 完成后要重命名，因为ae会追加00000到文件名末尾\n      if(item.status === RQItemStatus.DONE) {\n        let bug = new File(fileName + '00000');\n        if(bug.exists) {\n          bug.rename(name);\n        }\n      }\n    };\n    app.project.renderQueue.render();\n  },\n};\n","import { transformLayer } from './transform';\nimport vector from './vector';\nimport render from '../render';\n\nlet uuid = 0;\n\nfunction recursion(composition, library) {\n  let { name, layers, width, height, duration } = composition;\n  $.ae2karas.error('composition: ' + name);\n  // 先统计哪些层被作为父级链接\n  let asParent = {}, asChild = {};\n  for(let i = 1; i <= layers.length; i++) {\n    let item = layers[i];\n    if(item.parent && item.parent.index) {\n      asParent[item.parent.index] = true;\n      asChild[item.index] = item.parent.index;\n    }\n  }\n  // 是否是独奏模式\n  let hasSolo;\n  for(let i = 1; i <= layers.length; i++) {\n    let item = layers[i];\n    if(item.solo) {\n      hasSolo = true;\n      break;\n    }\n  }\n  let children = [];\n  // 遍历分析图层，独奏时只看独奏图层，否则看可见图层\n  for(let i = 1; i <= layers.length; i++) {\n    let item = layers[i];\n    let index = item.index;\n    // 根据是否独奏或可见决定是否分析或跳过，被作为父级链接的即便不可见也要统计\n    if(!asParent.hasOwnProperty(index)) {\n      if(hasSolo) {\n        if(!item.solo) {\n          continue;\n        }\n      }\n      else {\n        if(!item.enabled) {\n          continue;\n        }\n      }\n    }\n    let o = parseLayer(item, library);\n    if(o) {\n      // 父级打标uuid的同时，之前记录的hash也记录下来\n      if(asParent.hasOwnProperty(index)) {\n        asParent[index] = o.asParent = uuid++;\n      }\n      children.push(o);\n    }\n  }\n  // children还要遍历一遍，根据父级链接增加指向父级的字段\n  for(let i = 0; i < children.length; i++) {\n    let item = children[i];\n    let index = item.index;\n    if(asChild.hasOwnProperty(index)) {\n      item.asChild = asParent[asChild[index]];\n    }\n  }\n  children.reverse();\n  return {\n    type: 'div',\n    name,\n    width,\n    height,\n    duration: duration * 1000, // 合成的总时长\n    children,\n  };\n}\n\nfunction parseLayer(layer, library) {\n  let res = {\n    name: layer.name,\n    index: layer.index,\n    width: layer.width,\n    height: layer.height,\n    enabled: layer.solo || layer.enabled, // 可能是个隐藏的父级链接图层就false不可见\n    startTime: layer.startTime * 1000, // 开始时间，即时间轴上本图层初始位置\n    inPoint: layer.inPoint * 1000, // 真正开始显示时间，>= startTime，可能有前置空白不显示的一段\n    outPoint: layer.outPoint * 1000, // 真正结束显示时间，<= duration绝对值，可能有后置空白不显示的一段\n    blendingMode: layer.blendingMode,\n  };\n  $.ae2karas.warn('layer: ' + res.name);\n  let geom, txt;\n  for(let i = 1; i <= layer.numProperties; i++) {\n    let prop = layer.property(i);\n    if(prop && prop.enabled) {\n      let matchName = prop.matchName;\n      switch(matchName) {\n        case 'ADBE Transform Group':\n          res.transform = transformLayer(prop);\n          break;\n        case 'ADBE Root Vectors Group':\n          // 形状图层中的内容子属性\n          geom = vector(prop, library);\n          break;\n        case 'ADBE Mask Parade':\n          res.mask = mask(prop);\n          break;\n        case 'ADBE Text Properties':\n          txt = text(prop);\n          break;\n      }\n    }\n  }\n  let source = layer.source;\n  if(geom && geom.shape && geom.shape.content && geom.shape.content.type) {\n    geom.geom = true; // 特殊标识\n    geom.type = 'div';\n    geom.id = library.length;\n    library.push(geom);\n    res.assetId = geom.id;\n  }\n  else if(txt) {\n    txt.text = true; // 特殊标识\n    txt.type = 'span';\n    txt.id = library.length;\n    library.push(txt);\n    res.assetId = txt.id;\n  }\n  else if(source) {\n    let asset;\n    // 图片图形等独立资源，将其解析为被link的放入library即可\n    if(source instanceof FootageItem) {\n      let src = source.file && source.file.fsName;\n      let name = source.name;\n      if(/\\.psd$/.test(name)) {\n        let path = src.replace(/[^\\/]*\\.psd$/, '');\n        let newName = name.replace(/[\\/.]/g, '_') + '_layer_' + layer.index + '.png';\n        render.psd2png(source, src, path, newName);\n        src = path + newName;\n      }\n      if(!/\\.jpg$/.test(src)\n        && !/\\.jpeg$/.test(src)\n        && !/\\.png/.test(src)\n        && !/\\.webp/.test(src)\n        && !/\\.gif/.test(src)) {\n        return;\n      }\n      let hasExist;\n      for(let i = 0; i < library.length; i++) {\n        let item = library[i];\n        if(item.src === src && item.type === 'img') {\n          asset = item;\n          hasExist = true;\n          break;\n        }\n      }\n      if(!hasExist) {\n        if(src) {\n          asset = {\n            type: 'img',\n            name,\n            width: source.width,\n            height: source.height,\n            src,\n          };\n        }\n        // 颜色类型没有src\n        else {\n          asset = {\n            type: 'div',\n            width: source.width,\n            height: source.height,\n          }\n        }\n      }\n    }\n    // 合成，递归分析\n    else if(source instanceof CompItem) {\n      asset = recursion(source, library);\n      asset.type = 'div';\n    }\n    if(asset) {\n      asset.id = library.length;\n      library.push(asset);\n      res.assetId = asset.id;\n    }\n  }\n  return res;\n}\n\nfunction mask(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      if(matchName === 'ADBE Mask Atom') {\n        if(item.maskMode !== MaskMode.NONE) {\n          res.enabled = true;\n        }\n        res.points = item.property('maskShape').value;\n        res.opacity = item.property('Mask Opacity').value;\n        res.mode = item.maskMode;\n        res.inverted = item.inverted;\n      }\n    }\n  }\n  return res;\n}\n\nfunction text(prop) {\n  let res = {};\n  for(let i = 1; i <= prop.numProperties; i++) {\n    let item = prop.property(i);\n    if(item && item.enabled) {\n      let matchName = item.matchName;\n      switch(matchName) {\n        case 'ADBE Text Document':\n          let value = item.value;\n          res.content = {\n            fillColor: value.fillColor,\n            font: value.font,\n            fontFamily: value.fontFamily,\n            fontStyle: value.fontStyle,\n            fontSize: value.fontSize,\n            leading: value.leading,\n            text: value.text,\n          };\n          break;\n      }\n    }\n  }\n  return res;\n}\n\nexport default function(composition) {\n  // 递归遍历合成，转换ae的图层为普通js对象\n  let { workAreaStart, workAreaDuration } = composition;\n  workAreaStart *= 1000;\n  workAreaDuration *= 1000;\n  $.ae2karas.log('workArea: ' + workAreaStart + ',' + workAreaDuration);\n  let library = [];\n  let result = recursion(composition, library);\n  $.ae2karas.log(result);\n  $.ae2karas.log(library);\n  return {\n    workAreaStart,\n    workAreaDuration,\n    result,\n    library,\n  };\n}\n","/**\n * 2个及以上的关键帧，获取区间，有可能有超过范围的无效关键帧，需滤除\n * 也有可能不及工作区间，需补充首尾，和原有首尾一样复制一个出来对齐区间\n * 也有可能虽然在范围外，但范围上无关键帧，需截取至范围内，由每个特效传入截取回调\n * @param list\n * @param begin\n * @param duration\n * @param reducer 当关键帧范围在工作区间外时，每个特效传入的截取函数\n * @returns {(number|number)[]}\n */\nfunction getAreaList(list, begin, duration, reducer) {\n  let len = list.length;\n  let startIndex = 0, endIndex = len - 1;\n  // 在区间外围的如果只有1帧则需包括，多余的去除，正好则符合，包含则需填补\n  for(let i = 0; i < len; i++) {\n    let item = list[i];\n    if(item.time < begin) {\n      startIndex = i;\n    }\n    else if(item.time > begin) {\n      break;\n    }\n    else {\n      startIndex = i;\n      break;\n    }\n  }\n  // 结尾同上\n  for(let i = len - 1; i >= 0; i--) {\n    let item = list[i];\n    if(item.time < begin + duration) {\n      break;\n    }\n    else if(item.time > begin + duration) {\n      endIndex = i;\n    }\n    else {\n      endIndex = i;\n      break;\n    }\n  }\n  if(startIndex > 0 || endIndex < len - 1) {\n    list = list.slice(startIndex, endIndex + 1);\n  }\n  // 补齐首帧，当关键帧在工作区间内的时候\n  let first = list[0];\n  if(first.time > begin) {\n    let o = {\n      time: begin,\n      value: Array.isArray(first.value) ? first.value.slice(0) : first.value,\n    };\n    list.unshift(o);\n  }\n  // 截取首帧部分\n  else if(first.time < begin) {\n    let next = list[1];\n    let percent = (begin - first.time) / (next.time - first.time);\n    first.time = begin;\n    first.value = reducer(first.value, next.value, percent);\n    if(first.easing) {\n      let points = sliceBezier([\n        [0, 0],\n        [first.easing[0], first.easing[1]],\n        [first.easing[2], first.easing[3]],\n        [1, 1],\n      ].reverse(), percent).reverse();\n      first.easing = [points[1][0], points[1][1], points[2][0], points[2][1]];\n    }\n  }\n  // 截取尾帧部分，同上\n  let last = list[list.length - 1];\n  if(last.time > begin + duration) {\n    let prev = list[list.length - 2];\n    let percent = (begin + duration - prev.time) / (last.time - prev.time);\n    last.time = begin + duration;\n    last.value = reducer(prev.value, last.value, percent);\n    if(prev.easing) {\n      let points = sliceBezier([\n        [0, 0],\n        [prev.easing[0], prev.easing[1]],\n        [prev.easing[2], prev.easing[3]],\n        [1, 1],\n      ], percent);\n      prev.easing = [points[1][0], points[1][1], points[2][0], points[2][1]];\n    }\n  }\n  // 补齐尾帧，同上\n  else if(last.time < begin + duration) {\n    let o = {\n      time: begin + duration,\n      value: Array.isArray(last.value) ? last.value.slice(0) : last.value,\n    };\n    list.push(o);\n  }\n  return list;\n}\n\n/**\n * 百分比截取贝塞尔中的一段，t为[0, 1]\n * @param points\n * @param t\n */\nfunction sliceBezier(points, t) {\n  let [[x1, y1], [x2, y2], [x3, y3], p4] = points;\n  let x12 = (x2 - x1) * t + x1;\n  let y12 = (y2 - y1) * t + y1;\n  let x23 = (x3 - x2) * t + x2;\n  let y23 = (y3 - y2) * t + y2;\n  let x123 = (x23 - x12) * t + x12;\n  let y123 = (y23 - y12) * t + y12;\n  if(points.length === 4) {\n    let [x4, y4] = p4;\n    let x34 = (x4 - x3) * t + x3;\n    let y34 = (y4 - y3) * t + y3;\n    let x234 = (x34 - x23) * t + x23;\n    let y234 = (y34 - y23) * t + y23;\n    let x1234 = (x234 - x123) * t + x123;\n    let y1234 = (y234 - y123) * t + y123;\n    return [[x1, y1], [x12, y12], [x123, y123], [x1234, y1234]];\n  }\n  else if(points.length === 3) {\n    return [[x1, y1], [x12, y12], [x123, y123]];\n  }\n}\n\nexport function transformOrigin(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      transformOrigin: list[0][0] + ' ' + list[0][1],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        transformOrigin: item.value[0] + ' ' + item.value[1],\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformOpacity(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      opacity: list[0] * 0.01,\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        opacity: item.value * 0.01,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformPosition(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      translateX: list[0][0],\n      translateY: list[0][1],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n        prev[2] + (next[2] - prev[2]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        translateX: item.value[0],\n        translateY: item.value[1],\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformRotateX(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      rotateX: list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        rotateX: item.value,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformRotateY(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      rotateY: list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        rotateY: item.value,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\n\nexport function transformRotateZ(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    res.value.push({\n      rotateZ: list[0],\n    });\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return prev + (next - prev) * percent;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      res.value.push({\n        offset: (item.time - begin) / duration,\n        rotateZ: item.value,\n        easing: item.easing,\n      });\n    }\n  }\n  return res;\n}\n\nexport function transformScale(list, begin, duration) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let v = {\n      scaleX: list[0][0] * 0.01,\n      scaleY: list[0][1] * 0.01,\n    };\n    if(list[0].length > 2) {\n      v.scaleZ = list[0][2] * 0.01;\n    }\n    res.value.push(v);\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return [\n        prev[0] + (next[0] - prev[0]) * percent,\n        prev[1] + (next[1] - prev[1]) * percent,\n        prev[2] + (next[2] - prev[2]) * percent,\n      ];\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let v = {\n        offset: (item.time - begin) / duration,\n        scaleX: item.value[0] * 0.01,\n        scaleY: item.value[1] * 0.01,\n        easing: item.easing,\n      };\n      if(item.value.length > 2) {\n        v.scaleZ = item.value[2] * 0.01;\n      }\n      res.value.push(v);\n    }\n  }\n  return res;\n}\n\nexport function transformPath(list, begin, duration, isEnd) {\n  let res = {\n    value: [],\n    options: {\n      duration,\n      fill: 'forwards',\n    },\n  };\n  // 只有1帧没有动画，无需计算补间\n  if(list.length === 1) {\n    let v = {\n    };\n    if(isEnd) {\n      v.end = list[0] * 0.01;\n    }\n    else {\n      v.start = list[0] * 0.01;\n    }\n    res.value.push(v);\n  }\n  else {\n    list = getAreaList(list, begin, duration, function(prev, next, percent) {\n      return (prev + (next - prev) * percent) * 0.01;\n    });\n    for(let i = 0, len = list.length; i < len; i++) {\n      let item = list[i];\n      let v = {\n        offset: (item.time - begin) / duration,\n        easing: item.easing,\n      };\n      if(isEnd) {\n        v.end = item.value * 0.01;\n      }\n      else {\n        v.start = item.value * 0.01;\n      }\n      res.value.push(v);\n    }\n  }\n  return res;\n}\n","export default {\n  parse(vertices, inTangents, outTangents, closed) {\n    let x1 = vertices[0][0], y1 = vertices[0][1];\n    let x2 = x1, y2 = y1;\n    // 控制点是相对于顶点的坐标\n    let it = inTangents[0], ot = outTangents[0];\n    if(it[0]) {\n      x1 = Math.max(x1, x1 + it[0]);\n      x2 = Math.min(x2, x1 + it[0]);\n    }\n    if(it[1]) {\n      y1 = Math.max(y1, y1 + it[1]);\n      y2 = Math.min(y2, y1 + it[1]);\n    }\n    if(ot[0]) {\n      x1 = Math.max(x1, x1 + ot[0]);\n      x2 = Math.min(x2, x1 + ot[0]);\n    }\n    if(ot[1]) {\n      y1 = Math.max(y1, y1 + ot[1]);\n      y2 = Math.min(y2, y1 + ot[1]);\n    }\n    for(let i = 1, len = vertices.length; i < len; i++) {\n      let item = vertices[i];\n      x1 = Math.max(x1, item[0]);\n      y1 = Math.max(y1, item[1]);\n      x2 = Math.min(x2, item[0]);\n      y2 = Math.min(y2, item[1]);\n      // 控制点是相对于顶点的坐标\n      let it = inTangents[i], ot = outTangents[i];\n      if(it[0]) {\n        x1 = Math.max(x1, item[0] + it[0]);\n        x2 = Math.min(x2, item[0] + it[0]);\n      }\n      if(it[1]) {\n        y1 = Math.max(y1, item[1] + it[1]);\n        y2 = Math.min(y2, item[1] + it[1]);\n      }\n      if(ot[0]) {\n        x1 = Math.max(x1, item[0] + ot[0]);\n        x2 = Math.min(x2, item[0] + ot[0]);\n      }\n      if(ot[1]) {\n        y1 = Math.max(y1, item[1] + ot[1]);\n        y2 = Math.min(y2, item[1] + ot[1]);\n      }\n    }\n    let w = x1 - x2, h = y1 - y2;\n    let pts = [], cts = [];\n    for(let i = 0, len = vertices.length; i < len; i++) {\n      let item = vertices[i];\n      pts.push([\n        (item[0] - x2) / w,\n        (item[1] - y2) / h,\n      ]);\n      let it = inTangents[i], ot = outTangents[i];\n      // 上一个顶点到本顶点\n      if(it[0] || it[1]) {\n        let j = i - 1;\n        if(j === -1) {\n          j = len - 1;\n        }\n        cts[j] = cts[j] || [];\n        cts[j].push(pts[i][0] + it[0] / w);\n        cts[j].push(pts[i][1] + it[1] / h);\n      }\n      // 本顶点到下一个顶点\n      if(ot[0] || ot[1]) {\n        cts[i] = cts[i] || [];\n        cts[i].push(pts[i][0] + ot[0] / h);\n        cts[i].push(pts[i][1] + ot[1] / h);\n      }\n    }\n    if(closed) {\n      pts.push(pts[0].slice(0));\n    }\n    return {\n      x1,\n      y1,\n      x2,\n      y2,\n      width: w,\n      height: h,\n      points: pts,\n      controls: cts,\n    };\n  },\n  rect2polyline(width, height, roundness) {\n    roundness = roundness || 0;\n    let r = Math.min(width, height) * 0.5;\n    roundness = Math.min(roundness, r);\n    let pts = [], cts = [];\n    if(roundness && roundness > 0) {\n      let h = roundness * 0.5522847498307936;\n      pts.push([(width - roundness) / width, 0]);\n      cts.push([(width - roundness + h) / width, 0, 1, (roundness - h) / height]);\n      pts.push([1, roundness / height]);\n      cts.push([]);\n      pts.push([1, (height - roundness) / height]);\n      cts.push([1, (height - roundness + h) / height, (width - roundness + h) / width, 1]);\n      pts.push([(width - roundness) / width, 1]);\n      cts.push([]);\n      pts.push([roundness / width, 1]);\n      cts.push([(roundness - h) / width, 1, 0, (height - roundness + h) / height]);\n      pts.push([0, (height - roundness) / height]);\n      cts.push([]);\n      pts.push([0, roundness / height]);\n      cts.push([0, (roundness - h) / height, (roundness - h) / width, 0]);\n      pts.push([roundness / width, 0]);\n      cts.push([]);\n      pts.push([(width - roundness) / width, 0]);\n    }\n    else {\n      pts.push([1, 0]);\n      pts.push([1, 1]);\n      pts.push([0, 1]);\n      pts.push([0, 0]);\n      pts.push([1, 0]);\n    }\n    return {\n      points: pts,\n      controls: cts,\n    }\n  },\n  ellipse2polyline() {\n    let pts = [], cts = [];\n    let rx =  0.5 * 0.5522847498307936, ry = 0.5 * 0.5522847498307936;\n    pts.push([0.5, 0]);\n    cts.push([0.5 + rx, 0, 1, 0.5 - ry]);\n    pts.push([1, 0.5]);\n    cts.push([1, 0.5 + ry, 0.5 + rx, 1]);\n    pts.push([0.5, 1]);\n    cts.push([0.5 - rx, 1, 0, 0.5 + ry]);\n    pts.push([0, 0.5]);\n    cts.push([0, 0.5 - ry, rx, 0]);\n    pts.push([0.5, 0]);\n    return {\n      points: pts,\n      controls: cts,\n    }\n  },\n};\n","import {\n  transformOrigin,\n  transformOpacity,\n  transformPosition,\n  transformRotateX,\n  transformRotateY,\n  transformRotateZ,\n  transformScale,\n  transformPath,\n} from './animate';\nimport path from './path';\n\n/**\n * 预解析父级链接，不递归深入children，返回一个普通的div\n * @param data\n * @param library\n * @param start\n * @param duration\n * @param offset\n */\nfunction preParse(data, library, start, duration, offset) {\n  let { name, width, height, inPoint, outPoint } = data;\n  let begin = start + offset;\n  // 图层在工作区外特殊处理，取最近的一帧内容 TODO\n  if(inPoint >= begin + duration || outPoint <= begin) {\n    return null;\n  }\n  let res = {\n    name,\n    tagName: 'div',\n    props: {\n      style: {\n        position: 'absolute',\n        width,\n        height,\n      },\n    },\n    children: [],\n    animate: [],\n  };\n  parseAnimate(res, data, start, duration, offset, true, false);\n  return res;\n}\n\nfunction parseAnimate(res, data, start, duration, offset, isDirect, isGeom) {\n  let { width, height, transform } = data;\n  // 分别分析每个变换，过程很相似，当为单帧时需合并到init.style，多帧第一帧需合并且置空\n  let { anchorPoint, opacity, position, rotateX, rotateY, rotateZ, scale } = transform;\n  let begin2 = start - offset;\n  let init = isDirect ? res.props : res.init;\n  if(!isGeom && Array.isArray(anchorPoint) && anchorPoint.length) {\n    let t = transformOrigin(anchorPoint, begin2, duration);\n    let first = t.value[0];\n    let v = first.transformOrigin.split(' ');\n    v[0] = parseFloat(v[0]);\n    v[1] = parseFloat(v[1]);\n    if(v[0] !== width * 0.5 || v[1] !== height * 0.5) {\n      init.style.transformOrigin = first.transformOrigin;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      // tfo的每个动画需考虑对坐标的影响\n      for(let i = 1, len = t.value.length; i < len; i++) {\n        let item = t.value[i];\n        let tfo = item.transformOrigin.split(' ');\n        tfo[0] = parseFloat(tfo[0]);\n        tfo[1] = parseFloat(tfo[1]);\n        item.left = -tfo[0];\n        item.top = -tfo[1];\n      }\n      res.animate.push(t);\n    }\n    // ae中位置相对于anchor，而不是默认左上角原点，因此有个位置计算\n    if(v[0]) {\n      init.style.left = -v[0];\n    }\n    if(v[1]) {\n      init.style.top = -v[1];\n    }\n  }\n  if(Array.isArray(opacity) && opacity.length) {\n    let t = transformOpacity(opacity, begin2, duration);\n    let first = t.value[0];\n    if(first.opacity !== 1) {\n      init.style.opacity = first.opacity;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  if(Array.isArray(position) && position.length) {\n    let t = transformPosition(position, begin2, duration);\n    let first = t.value[0];\n    if(first.translateX) {\n      init.style.translateX = first.translateX;\n    }\n    if(first.translateY) {\n      init.style.translateY = first.translateY;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  if(Array.isArray(rotateX) && rotateX.length) {\n    let t = transformRotateX(rotateX, begin2, duration);\n    let first = t.value[0];\n    if(first.rotateX) {\n      init.style.rotateX = first.rotateX;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  if(Array.isArray(rotateY) && rotateY.length) {\n    let t = transformRotateY(rotateY, begin2, duration);\n    let first = t.value[0];\n    if(first.rotateY) {\n      init.style.rotateY = first.rotateY;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  if(Array.isArray(rotateZ) && rotateZ.length) {\n    let t = transformRotateZ(rotateZ, begin2, duration);\n    let first = t.value[0];\n    if(first.rotateZ) {\n      init.style.rotateZ = first.rotateZ;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  if(Array.isArray(scale) && scale.length) {\n    let t = transformScale(scale, begin2, duration);\n    let first = t.value[0];\n    if(first.scaleX !== 1) {\n      init.style.scaleX = first.scaleX;\n    }\n    if(first.scaleY !== 1) {\n      init.style.scaleY = first.scaleY;\n    }\n    if(first.scaleZ !== 1) {\n      init.style.scaleZ = first.scaleZ;\n    }\n    if(t.value.length > 1) {\n      if(first.offset === 0) {\n        t.value[0] = {\n          offset: 0,\n        };\n      }\n      res.animate.push(t);\n    }\n  }\n  return res;\n}\n\n/**\n * 动画和初始init部分转换\n * @param data\n * @param library\n * @param newLib\n * @param start\n * @param duration\n * @param offset\n * @param parentLink\n */\nfunction recursion(data, library, newLib, start, duration, offset, parentLink) {\n  // 作为父级链接不可见时无需导出\n  if(!data.enabled) {\n    return null;\n  }\n  let { name, assetId, startTime, inPoint, outPoint, blendingMode } = data;\n  if(assetId === undefined || assetId === null) {\n    return null;\n  }\n  let begin = start + offset;\n  // 图层在工作区外可忽略\n  if(inPoint >= begin + duration || outPoint <= begin) {\n    return null;\n  }\n  let res = {\n    name,\n  };\n  res.libraryId = parse(library, assetId, newLib, start, duration, offset + startTime);\n  res.init = {\n    style: {},\n  };\n  // 混合模式\n  switch(blendingMode) {\n    case BlendingMode.MULTIPLY:\n      res.init.style.mixBlendMode = 'multiply';\n      break;\n    case BlendingMode.SCREEN:\n      res.init.style.mixBlendMode = 'screen';\n      break;\n    case BlendingMode.OVERLAY:\n      res.init.style.mixBlendMode = 'overlay';\n      break;\n    case BlendingMode.DARKEN:\n      res.init.style.mixBlendMode = 'darken';\n      break;\n    case BlendingMode.COLOR_DODGE:\n      res.init.style.mixBlendMode = 'color-dodge';\n      break;\n    case BlendingMode.COLOR_BURN:\n      res.init.style.mixBlendMode = 'color-burn';\n      break;\n    case BlendingMode.HARD_LIGHT:\n      res.init.style.mixBlendMode = 'hard-light';\n      break;\n    case BlendingMode.SOFT_LIGHT:\n      res.init.style.mixBlendMode = 'soft-light';\n      break;\n    case BlendingMode.DIFFERENCE:\n      res.init.style.mixBlendMode = 'difference';\n      break;\n    case BlendingMode.EXCLUSION:\n      res.init.style.mixBlendMode = 'exclusion';\n      break;\n    case BlendingMode.HUE:\n      res.init.style.mixBlendMode = 'hue';\n      break;\n    case BlendingMode.SATURATION:\n      res.init.style.mixBlendMode = 'saturation';\n      break;\n    case BlendingMode.COLOR:\n      res.init.style.mixBlendMode = 'color';\n      break;\n    case BlendingMode.LUMINOSITY:\n      res.init.style.mixBlendMode = 'luminosity';\n      break;\n  }\n  res.animate = [];\n  // 特殊的visibility动画，如果图层可见在工作区间内，需要有动画，否则可以无视\n  if(inPoint > begin || outPoint < begin + duration) {\n    let v = {\n      value: [],\n      options: {\n        duration,\n        fill: 'forwards',\n      },\n    };\n    // 开头不可见，默认init的style\n    if(inPoint > begin) {\n      res.init.style.visibility = 'hidden';\n      res.init.style.pointerEvents = 'none';\n      v.value.push({\n        offset: 0,\n      });\n      v.value.push({\n        offset: (inPoint - begin) / duration,\n        visibility: 'inherit',\n        pointerEvents: 'auto',\n      });\n    }\n    // 结尾计算\n    if(outPoint < begin + duration) {\n      // 可能是第一帧但offset不为0，不用担心karas会补充空首帧\n      v.value.push({\n        offset: (outPoint - begin) / duration,\n        visibility: 'hidden',\n        pointerEvents: 'none',\n      });\n      // 默认不是隐藏需补结束帧为隐藏，否则karas会填补空关键帧\n      if(inPoint <= begin) {\n        v.value.push({\n          offset: 1,\n          visibility: 'hidden',\n          pointerEvents: 'none',\n        });\n      }\n    }\n    res.animate.push(v);\n  }\n  parseAnimate(res, data, start, duration, offset, false, false);\n  if(data.hasOwnProperty('asChild')) {\n    let asChild = data.asChild;\n    if(parentLink.hasOwnProperty(asChild)) {\n      let div = JSON.stringify(parentLink[asChild]);\n      div = JSON.parse(div);\n      div.children.push(res);\n      res = div;\n    }\n  }\n  return res;\n}\n\n/**\n * 静态部分转换，library中无动画的部分\n * @param library\n * @param assetId\n * @param newLib\n * @param start\n * @param duration\n * @param offset\n */\nfunction parse(library, assetId, newLib, start, duration, offset) {\n  let data = library[assetId];\n  let { type, name, src, width, height, children, geom, text } = data;\n  let res = {\n    id: -1, // 占位符\n    name,\n    tagName: type,\n    props: {\n      style: {\n        position: 'absolute',\n        width,\n        height,\n      },\n    },\n  };\n  // 矢量图层特殊解析，添加\n  if(geom) {\n    parseGeom(res, data, start, duration, offset);\n  }\n  else if(text) {\n    let content = data.content;\n    res.props.style.color = [\n      parseInt(content.fillColor[0] * 255),\n      parseInt(content.fillColor[1] * 255),\n      parseInt(content.fillColor[2] * 255),\n    ];\n    res.props.style.fontFamily = content.fontFamily;\n    res.props.style.fontSize = content.fontSize;\n    res.props.style.fontStyle = content.fontStyle;\n    res.props.style.lineHeight = content.leading / content.fontSize;\n    res.children = [content.text];\n  }\n  // 图片无children\n  else if(type === 'img') {\n    res.props.src = src;\n  }\n  else if(Array.isArray(children)) {\n    res.children = [];\n    parseChildren(res, children, library, newLib, start, duration, offset);\n  }\n  res.id = newLib.length;\n  newLib.push(res);\n  return res.id;\n}\n\nfunction parseChildren(res, children, library, newLib, start, duration, offset) {\n  if(Array.isArray(children)) {\n    // 先一遍解析父级链接，因为父级可能不展示或者只需要父级一层不递归解析父级的children\n    let parentLink = {};\n    for(let i = 0, len = children.length; i < len; i++) {\n      let item = children[i];\n      if(item.hasOwnProperty('asParent')) {\n        parentLink[item.asParent] = preParse(item, library, start, duration, offset);\n      }\n    }\n    // 再普通解析，遇到父级链接特殊处理\n    for(let i = 0, len = children.length; i < len; i++) {\n      let item = children[i];\n      let temp = recursion(item, library, newLib, start, duration, offset, parentLink);\n      if(temp) {\n        res.children.push(temp);\n        if(item.mask && item.mask.enabled) {\n          res.children.push(parseMask(item, temp));\n        }\n      }\n    }\n  }\n}\n\n/**\n * 形状图层特殊的直接为其生成一个内联children\n * @param res\n * @param data\n * @param start\n * @param duration\n * @param offset\n */\nfunction parseGeom(res, data, start, duration, offset) {\n  let { shape: { content, fill, stroke, transform }, trim } = data;\n  let { type, direction, size, position, roundness, points } = content;\n  let f;\n  if(fill) {\n    f = [\n      parseInt(fill.color[0] * 255),\n      parseInt(fill.color[1] * 255),\n      parseInt(fill.color[2] * 255),\n      fill.color[3]\n    ];\n    if(fill.opacity !== 100) {\n      f[3] *= fill.opacity * 0.01;\n    }\n  }\n  let s;\n  if(stroke) {\n    s = [\n      parseInt(stroke.color[0] * 255),\n      parseInt(stroke.color[1] * 255),\n      parseInt(stroke.color[2] * 255),\n      stroke.color[3]\n    ];\n    if(stroke.opacity !== 100) {\n      s[3] *= stroke.opacity * 0.01;\n    }\n  }\n  let child = {\n    tagName: '$polyline',\n    props: {\n      style: {\n        position: 'absolute',\n        fill: [f],\n        strokeWidth: [stroke.width],\n        stroke: [s],\n        strokeLinejoin: [stroke.lineJoin],\n        strokeMiterlimit: [stroke.miterLimit],\n      },\n    },\n    animate: [],\n  };\n  if(stroke.dashes) {\n    child.props.style.strokeDasharray = [stroke.dashes];\n  }\n  if(type === 'rect') {\n    child.props.style.width = size[0];\n    child.props.style.height = size[1];\n    let o = path.rect2polyline(size[0], size[1], roundness);\n    child.props.points = o.points;\n    child.props.controls = o.controls;\n  }\n  else if(type === 'ellipse') {\n    child.props.style.width = size[0];\n    child.props.style.height = size[1];\n    let o = path.ellipse2polyline();\n    child.props.points = o.points;\n    child.props.controls = o.controls;\n  }\n  else if(type === 'star') {\n    // TODO\n  }\n  else if(type === 'path') {\n    let { vertices, inTangents, outTangents, closed } = points;\n    let o = path.parse(vertices, inTangents, outTangents, closed);\n    child.props.style.width = o.width;\n    child.props.style.height = o.height;\n    child.props.points = o.points\n    child.props.controls = o.controls;\n    // path的特殊位置计算\n    child.props.style.left = o.x2;\n    child.props.style.top = o.y2;\n  }\n  // path没有position\n  if(position && position[0]) {\n    child.props.style.left = -position[0];\n  }\n  if(position && position[1]) {\n    child.props.style.top = -position[1];\n  }\n  if(fill && fill.rule === 2) {\n    child.props.style.fillRule = 'evenodd';\n  }\n  // geom内嵌的transform单独分析，anchorPoint比较特殊\n  let { anchorPoint } = transform;\n  let begin2 = start - offset;\n  if(Array.isArray(anchorPoint) && anchorPoint.length) {\n    let t = transformOrigin(anchorPoint, begin2, duration);\n    let first = t.value[0];\n    let v = first.transformOrigin.split(' ');\n    v[0] = parseFloat(v[0]);\n    v[1] = parseFloat(v[1]);\n    /**\n     * path很特殊，原始没有宽高，ae是锚点0,0相对于自身左上角原点，定位则是锚点来进行定位\n     * 需记录最初的位置，发生锚点动画时，其会干扰left/top，同步形成位置动画\n     */\n    if(type === 'path') {\n      let left = child.props.style.left;\n      let top = child.props.style.top;\n      child.props.style.left -= v[0];\n      child.props.style.top -= v[1];\n      let w = child.props.style.width;\n      let h = child.props.style.height;\n      v[0] += w * 0.5;\n      v[1] += h * 0.5;\n      if(v[0] !== w * 0.5 || v[1] !== h * 0.5) {\n        child.props.style.transformOrigin = first.transformOrigin;\n      }\n      if(t.value.length > 1) {\n        if(first.offset === 0) {\n          t.value[0] = {\n            offset: 0,\n          };\n        }\n        // tfo的每个动画需考虑对坐标的影响\n        for(let i = 1, len = t.value.length; i < len; i++) {\n          let item = t.value[i];\n          let tfo = item.transformOrigin.split(' ');\n          tfo[0] = parseFloat(tfo[0]);\n          tfo[1] = parseFloat(tfo[1]);\n          item.left = left - tfo[0];\n          item.top = top - tfo[1];\n        }\n        child.animate.push(t);\n      }\n    }\n    else {\n      // tfo中心判断，加上尺寸*0.5\n      v[0] += size[0] * 0.5;\n      v[1] += size[1] * 0.5;\n      if(v[0] !== size[0] * 0.5 || v[1] !== size[1] * 0.5) {\n        child.props.style.transformOrigin = first.transformOrigin;\n      }\n      if(t.value.length > 1) {\n        if(first.offset === 0) {\n          t.value[0] = {\n            offset: 0,\n          };\n        }\n        child.animate.push(t);\n      }\n      if(v[0]) {\n        child.props.style.left = -v[0];\n      }\n      if(v[1]) {\n        child.props.style.top = -v[1];\n      }\n    }\n  }\n  parseAnimate(child, data.shape, start, duration, offset, true, true);\n  // trimPath裁剪动画或属性\n  if(trim && trim.hasOwnProperty('start') && trim.hasOwnProperty('end')) {\n    let start = trim.start, end = trim.end;\n    if(start.length > 1) {\n      let t = transformPath(start, begin2, duration, false);\n      let first = t.value[0];\n      if(first.start !== 0) {\n        child.props.start = first.start;\n      }\n      if(t.value.length > 1) {\n        if(first.offset === 0) {\n          t.value[0] = {\n            offset: 0,\n          };\n        }\n        child.animate.push(t);\n      }\n    }\n    else {\n      child.props.start = start[0] * 0.01;\n    }\n    if(end.length > 1) {\n      let t = transformPath(end, begin2, duration, true);\n      let first = t.value[0];\n      if(first.end !== 0) {\n        child.props.end = first.end;\n      }\n      if(t.value.length > 1) {\n        if(first.offset === 0) {\n          t.value[0] = {\n            offset: 0,\n          };\n        }\n        child.animate.push(t);\n      }\n    }\n    else {\n      child.props.end = end[0] * 0.01;\n    }\n  }\n  res.children = [child];\n}\n\nfunction parseMask(data, target) {\n  let left = target.init.style.left || 0;\n  let top = target.init.style.top || 0;\n  let res = {\n    tagName: '$polyline',\n    props: {\n      style: {\n        position: 'absolute',\n        fill: '#FFF',\n      },\n    },\n  };\n  let { width, height, mask: { points, opacity, mode, inverted } } = data;\n  if(opacity < 100) {\n    res.props.style.opacity = opacity * 0.01;\n  }\n  // 相加之外都是相减\n  if(mode === MaskMode.ADD) {\n    if(inverted) {\n      res.props.clip = true;\n    }\n    else {\n      res.props.mask = true;\n    }\n  }\n  else {\n    if(inverted) {\n      res.props.mask = true;\n    }\n    else {\n      res.props.clip = true;\n    }\n  }\n  // 获取对象锚点，mask的锚点需保持相同\n  let transformOrigin = target.init.style.transformOrigin;\n  let cx = width * 0.5, cy = height * 0.5;\n  if(transformOrigin) {\n    let v = transformOrigin.split(' ');\n    cx = parseFloat(v[0]);\n    cy = parseFloat(v[1]);\n  }\n  let { vertices, inTangents, outTangents, closed } = points;\n  let o = path.parse(vertices, inTangents, outTangents, closed);\n  res.props.style.width = o.width;\n  res.props.style.height = o.height;\n  res.props.points = o.points\n  res.props.controls = o.controls;\n  // 样式和target一致\n  let style = target.init.style;\n  for(let i in style) {\n    if(style.hasOwnProperty(i)) {\n      res.props.style[i] = style[i];\n    }\n  }\n  // 位置和锚点保持和mask相同，由于points可能不是0，0开始，需计算偏移\n  res.props.style.transformOrigin = (cx - o.x2) + ' ' + (cy - o.y2);\n  res.props.style.left = left + o.x2;\n  res.props.style.top = top + o.y2;\n  return res;\n}\n\nexport default function(data) {\n  $.ae2karas.error('convert');\n  let { workAreaStart, workAreaDuration, result, library } = data;\n  let { name, width, height, children } = result;\n  let newLib = [];\n  let res = {\n    name,\n    tagName: 'div',\n    props: {\n      style: {\n        position: 'absolute',\n        width,\n        height,\n      },\n    },\n    children: [],\n    library: newLib,\n    abbr: false,\n  };\n  parseChildren(res, children, library, newLib, workAreaStart, workAreaDuration, 0);\n  return res;\n}\n","import enums from './enums';\nimport parse from './parse/index';\nimport convert from './convert/index';\n\nconst { ES_TYPE, EVENT } = enums;\n\nlet ae2karas = $.ae2karas = $.ae2karas || {};\n\nae2karas.dispatch = (function() {\n  let xLib;\n  try {\n    xLib = new ExternalObject('lib:PlugPlugExternalObject');\n  } catch(e) {\n    alert('Missing ExternalObject: ');\n  }\n  return function(type, data) {\n    if(xLib) {\n      if(data && data instanceof Object) {\n        data = JSON.stringify(data);\n      }\n      else if(data === undefined) {\n        data = 'undefined';\n      }\n      else if(data === null) {\n        data = 'null';\n      }\n      else if(data === true) {\n        data = 'true';\n      }\n      else if(data === false) {\n        data = 'false';\n      }\n      // if(typeof data === 'number') {\n      //   data = data.toString();\n      // }\n      var eventObj = new CSXSEvent();\n      eventObj.type = type;\n      eventObj.data = data;\n      eventObj.dispatch();\n    }\n  };\n})();\n\nae2karas.log = function(s) {\n  $.ae2karas.dispatch(enums.EVENT.LOG, s);\n};\n\nae2karas.warn = function(s) {\n  $.ae2karas.dispatch(enums.EVENT.WARN, s);\n};\n\nae2karas.error = function(s) {\n  $.ae2karas.dispatch(enums.EVENT.ERROR, s);\n};\n\nfunction getItemType(item) {\n  let getType = {};\n  let type = getType.toString.call(item);\n  switch(type) {\n    case '[object FolderItem]':\n      return ES_TYPE.FOLDER_ITEM;\n    case '[object FootageItem]':\n      return ES_TYPE.FOOTAGE_ITEM;\n    case '[object CompItem]':\n      return ES_TYPE.COMP_ITEM;\n  }\n  return type;\n}\n\nae2karas.getCompositions = function() {\n  let folderItem = app.project;\n  let list = [];\n  // 所有的合成都在app.project下，包含文件夹递归树的\n  for(let i = 1; i <= folderItem.numItems; i++) {\n    let compItem = folderItem.item(i);\n    let type = getItemType(compItem);\n    if(type === ES_TYPE.COMP_ITEM) {\n      list.push({\n        id: compItem.id,\n        name: compItem.name,\n        width: compItem.width,\n        height: compItem.height,\n        type,\n      });\n    }\n  }\n  $.ae2karas.dispatch(EVENT.INIT, list);\n};\n\nfunction findCompositionById(id) {\n  for(let i = 1; i <= app.project.numItems; i++) {\n    const compItem = app.project.item(i);\n    if(compItem.id === id) {\n      return compItem;\n    }\n  }\n  return null;\n}\n\nae2karas.convert = function(id) {\n  let composition = findCompositionById(id);\n  if(!composition) {\n    return;\n  }\n  // 递归遍历分析合成对象，转换ae的图层为普通js对象，留给后续转换karas用\n  let res = parse(composition);\n  $.ae2karas.dispatch(enums.EVENT.FINISH, convert(res));\n  // 结束后才能删除临时生成的导出psd的合成和渲染队列\n  $.ae2karas.delTemp();\n};\n\nlet list = [];\nae2karas.addTemp = function(o) {\n  list.push(o);\n};\nae2karas.delTemp = function() {\n  while(list.length) {\n    list.pop().remove();\n  }\n};\n"],"names":["ES_TYPE","FOLDER_ITEM","FOOTAGE_ITEM","COMP_ITEM","EVENT","INIT","LOG","WARN","ERROR","FINISH","ADD_TEMP","DEL_TEMP","LAYER_TRANSFORM","VECTOR_TRANSFORM","getPropertyValues","prop","numKeys","arr","i","push","time","keyTime","value","keyValue","easing","undefined","getEasing","start","end","t1","t2","v1","v2","e1","keyOutTemporalEase","e2","keyInTemporalEase","x1","influence","x2","y1","y2","matchName","indexOf","avSpeedX","Math","abs","avSpeedY","avSpeed","sqrt","speed","transformLayer","res","numProperties","item","property","enabled","hasOwnProperty","transformVector","group","content","transform","name","rect","ellipse","star","path","stroke","fill","gfill","gFill","type","direction","size","position","roundness","starType","points","innerRadius","outerRadius","innerRoundness","outerRoundness","rotation","color","opacity","width","lineCap","lineJoin","miterLimit","dashes","d","g","canSetExpression","j","exec","length","v","len","rule","library","shape","trim","psd2png","source","psd","helperSequenceComp","app","project","items","addComp","height","layers","add","$","ae2karas","addTemp","renderQueue","outputModule","applyTemplate","fileName","file","File","exists","remove","onStatusChanged","status","RQItemStatus","DONE","bug","rename","render","uuid","recursion","composition","duration","error","asParent","asChild","parent","index","hasSolo","solo","children","o","parseLayer","reverse","layer","startTime","inPoint","outPoint","blendingMode","warn","geom","txt","vector","mask","text","id","assetId","asset","FootageItem","src","fsName","test","replace","newName","hasExist","CompItem","maskMode","MaskMode","NONE","mode","inverted","fillColor","font","fontFamily","fontStyle","fontSize","leading","workAreaStart","workAreaDuration","log","result","getAreaList","list","begin","reducer","startIndex","endIndex","slice","first","Array","isArray","unshift","next","percent","sliceBezier","last","prev","t","x3","y3","p4","x12","y12","x23","y23","x123","y123","x4","y4","x34","y34","x234","y234","x1234","y1234","transformOrigin","options","offset","transformOpacity","transformPosition","translateX","translateY","transformRotateX","rotateX","transformRotateY","rotateY","transformRotateZ","rotateZ","transformScale","scaleX","scaleY","scaleZ","transformPath","isEnd","parse","vertices","inTangents","outTangents","closed","it","ot","max","min","w","h","pts","cts","controls","rect2polyline","r","ellipse2polyline","rx","ry","preParse","data","tagName","props","style","animate","parseAnimate","isDirect","isGeom","anchorPoint","scale","begin2","init","split","parseFloat","tfo","left","top","newLib","parentLink","libraryId","BlendingMode","MULTIPLY","mixBlendMode","SCREEN","OVERLAY","DARKEN","COLOR_DODGE","COLOR_BURN","HARD_LIGHT","SOFT_LIGHT","DIFFERENCE","EXCLUSION","HUE","SATURATION","COLOR","LUMINOSITY","visibility","pointerEvents","div","JSON","stringify","parseGeom","parseInt","lineHeight","parseChildren","temp","parseMask","f","s","child","strokeWidth","strokeLinejoin","strokeMiterlimit","strokeDasharray","fillRule","target","ADD","clip","cx","cy","abbr","enums","dispatch","xLib","ExternalObject","e","alert","Object","eventObj","CSXSEvent","getItemType","getType","toString","call","getCompositions","folderItem","numItems","compItem","findCompositionById","convert","delTemp","pop"],"mappings":"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"}